import{d as q,r as z,o as O,e as K,f as Q,g as Y,a as Z,c as D,b as p,A as ee,i as x,w as g,j as v,k as F,B as te,F as ne,h as ae,_ as oe}from"./index-1scugG01.js";import{S as ie,P as se,W as ce,j as le,A as re,T as de}from"./three.module-CVsY17GA.js";import{s as ue,l as pe,p as me,m as fe,a as xe,q as R,r as E,u as A,v as j,g as B,f as N,w as ge,x as ve,b as _e,y as be,z as he}from"./threeApi-DOkTKUH7.js";import{c as we}from"./GUI-B53Psxen.js";import"./EffectComposer-CXsZCJ3S.js";const Ce={class:"btn"},ye=q({__name:"index",setup(Pe){const y=z();let o,m=[],P=[],c=[null,null,null],r={clipSpeed:.006,pipeRadius:8},l,_,d;const k=z(!1);O(()=>o=V(y.value)),K(()=>o.GUI&&o.GUI.destroy()),Q(()=>{o.GUI.domElement.hidden=!1}),Y(()=>o.GUI.domElement.hidden=!0);function L(){l.Now.time=.2,l.Now.paused=!0}function M(){d.position.set(...m[0]),c.map(n=>o.scene.remove(n)),c=[null,null,null],W(C)}function U(){P.map(n=>o.scene.remove(n)),P=[],m=[]}function W(n){o.outlinePass.selectedObjects=[d],d.position.set(...m.at(0)),c[0]=R(n,"https://img2.baidu.com/it/u=2867681562,1586644503&fm=253&app=138&size=w931&n=0&f=JPEG&fmt=auto?sec=1677862800&t=ca5f653200ddc4f64f164b75d22b44c2",.85,r.pipeRadius/4),c[0].material=o.scene.getObjectByName("G033").material.clone(),o.scene.add(c[0]);const a=E(c[0]);a.clipFace_Way._x.clip.constant-=a.clipFace_Way._x.width,_=A(n,d,r.clipSpeed,"go",(e,t)=>{const i=t.x-e.position.x;a.clipFace_Way._x.clip.constant+=i,e.rotation.x+=1,e.lookAt(t)},function(){c[1]=R(n,"https://img1.baidu.com/it/u=543378194,3252169155&fm=253&app=120&size=w931&n=0&f=JPEG&fmt=auto?sec=1677862800&t=b08f53a622ceb0c466234f3aff61a379",1,r.pipeRadius),c[1].material=o.scene.getObjectByName("Object023").material.clone(),o.scene.add(c[1]);const e=E(c[1]);e.clipFace_Way.z.clip.constant-=e.clipFace_Way.z.width/5,e.clipFace_Way.x.clip.constant-=e.clipFace_Way.x.width,_=A(n,d,r.clipSpeed,"back",(t,i)=>{const s=i.x-t.position.x;e.clipFace_Way.x.clip.constant-=s,t.lookAt(i)},function(){c[2]=R(n,"https://img1.baidu.com/it/u=2858466579,1111354287&fm=253&fmt=auto&app=138&f=JPEG?w=499&h=375",1,r.pipeRadius/2.5),c[2].material=o.scene.getObjectByName("Object041").material.clone(),o.scene.add(c[2]);const t=E(c[2]);_=A(n,d,r.clipSpeed,"back",(i,s)=>{const u=s.x-i.position.x;t.clipFace_Way.x.clip.constant-=u,i.lookAt(s)},function(){_=null})})})}let C,h=null,b=!0;function H(n){if(b)return;if(n.button===2)return b=!0;const a=B(n),e=N(a,o.camera,o.scene);if(e){const{object:t,face:i,point:s}=e;s.z+=r.pipeRadius;const u=he(s);o.scene.add(u),d.lookAt(s),d.position.copy(s),m.push(s),P.push(u)}}function T(n){if(b&&m.length>1){C=j(m),h.geometry.setFromPoints(C.getPoints(100));return}const a=B(n),e=N(a,o.camera,o.scene);if(e){const{point:t}=e;if(t.z+=r.pipeRadius,m.length<1)return;const s=j([...m,t]).getPoints(100);h?h.geometry.setFromPoints(s):(h=ge(s,"white"),o.scene.add(h))}}function V(n){const a=new ie,e=new se(50,n.clientWidth/n.clientHeight,.001,1e5);a.add(e);const t=new ce({antialias:!0,alpha:!0,logarithmicDepthBuffer:!0});t.setSize(n.clientWidth,n.clientHeight),t.setPixelRatio(window.devicePixelRatio*2),t.shadowMap.enabled=!0,t.shadowMap.type=le,t.gammaInput=!0,t.gammaOutput=!0,t.gammaFactor=2.2,t.autoClear=!0,t.setClearColor(16777215),t.localClippingEnabled=!0,n.appendChild(t.domElement);const i=ue(e,t);i.addEventListener("change",()=>i.target.y<0&&(i.target.y=0));const s=new re(5500);a.add(s);const u=we(de,a,e,i);u.add(r,"pipeRadius").min(1).max(30).name("管子大小"),u.add(r,"clipSpeed").min(1e-4).max(.01).name("速度"),pe("http://guangfu/resource/chuankuayue.FBX",f=>{const I=u.addFolder("模型["+Date.now()+"]");["x","y","z"].forEach(w=>I.add(f.position,w).min(-500).max(500).name(w+"轴坐标")),["x","y","z"].forEach(w=>I.add(f.scale,w).min(0).max(10).name(w+"缩放")),a.add(f),l=ve(f),l.runAction(l.actions[0],8),l.Now=l.runAction(l.actions[0],8),l.Now.play()}),me("http://guangfu/resource/car.glb",f=>{d=f,f.scale.set(100,100,100),a.add(f)});const{Composer:$,outlinePass:J}=fe(a,e,t,n),G=xe(),X=_e(60);S();function S(){X(()=>{G&&G.update(),l&&l.mixerRender(),!k.value&&_&&_(),o&&o.outlinePass.selectedObjects.length>0?$.render():t.render(a,e)}),y.value&&requestAnimationFrame(S)}return window.onresize=()=>{e.aspect=n.clientWidth/n.clientHeight,e.updateProjectionMatrix(),t.setSize(n.clientWidth,n.clientHeight)},{scene:a,camera:e,renderer:t,controls:i,GUI:u,outlinePass:J}}return(n,a)=>{const e=ae("el-button");return Z(),D(ne,null,[p("div",{ref_key:"threeDom",ref:y,class:"threeDom",onMousedown:ee(H,["prevent","stop"]),onMousemove:T},null,544),p("div",Ce,[p("div",null,[x(e,{onClick:U},{default:g(()=>[v("清除点")]),_:1})]),p("div",null,[x(e,{onClick:a[0]||(a[0]=t=>W(F(C)))},{default:g(()=>[v("根据曲线生成管道")]),_:1})]),p("div",null,[x(e,{onClick:a[1]||(a[1]=t=>k.value=!k.value)},{default:g(()=>[v("暂停")]),_:1})]),p("div",null,[x(e,{onClick:a[2]||(a[2]=t=>te(b)?b.value=!1:b=!1)},{default:g(()=>[v("绘制/继续绘制")]),_:1})]),p("div",null,[x(e,{onClick:a[3]||(a[3]=t=>F(be)(F(o).controls))},{default:g(()=>[v("偏移")]),_:1})]),p("div",null,[x(e,{onClick:L},{default:g(()=>[v("动画停止")]),_:1})]),p("div",null,[x(e,{onClick:M},{default:g(()=>[v("重播")]),_:1})])])],64)}}}),We=oe(ye,[["__scopeId","data-v-affcbecf"]]);export{We as default};
