(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0dd850"],{8277:function(t,e,n){"use strict";n.d(e,"a",(function(){return Ve}));var r={};n.r(r),n.d(r,"Deflate",(function(){return At})),n.d(r,"AsyncDeflate",(function(){return Et})),n.d(r,"deflate",(function(){return Dt})),n.d(r,"deflateSync",(function(){return Ct})),n.d(r,"Inflate",(function(){return Pt})),n.d(r,"AsyncInflate",(function(){return Lt})),n.d(r,"inflate",(function(){return Ft})),n.d(r,"inflateSync",(function(){return St})),n.d(r,"Gzip",(function(){return Nt})),n.d(r,"AsyncGzip",(function(){return Rt})),n.d(r,"gzip",(function(){return Ot})),n.d(r,"gzipSync",(function(){return Bt})),n.d(r,"Gunzip",(function(){return Ut})),n.d(r,"AsyncGunzip",(function(){return zt})),n.d(r,"gunzip",(function(){return Vt})),n.d(r,"gunzipSync",(function(){return jt})),n.d(r,"Zlib",(function(){return Gt})),n.d(r,"AsyncZlib",(function(){return Xt})),n.d(r,"zlib",(function(){return Wt})),n.d(r,"zlibSync",(function(){return Ht})),n.d(r,"Unzlib",(function(){return _t})),n.d(r,"AsyncUnzlib",(function(){return Zt})),n.d(r,"unzlib",(function(){return Kt})),n.d(r,"unzlibSync",(function(){return Yt})),n.d(r,"compress",(function(){return Ot})),n.d(r,"AsyncCompress",(function(){return Rt})),n.d(r,"compressSync",(function(){return Bt})),n.d(r,"Compress",(function(){return Nt})),n.d(r,"Decompress",(function(){return qt})),n.d(r,"AsyncDecompress",(function(){return Qt})),n.d(r,"decompress",(function(){return $t})),n.d(r,"decompressSync",(function(){return Jt})),n.d(r,"DecodeUTF8",(function(){return ie})),n.d(r,"EncodeUTF8",(function(){return ae})),n.d(r,"strToU8",(function(){return se})),n.d(r,"strFromU8",(function(){return ce})),n.d(r,"ZipPassThrough",(function(){return me})),n.d(r,"ZipDeflate",(function(){return ve})),n.d(r,"AsyncZipDeflate",(function(){return ye})),n.d(r,"Zip",(function(){return we})),n.d(r,"zip",(function(){return be})),n.d(r,"zipSync",(function(){return xe})),n.d(r,"UnzipPassThrough",(function(){return Ie})),n.d(r,"UnzipInflate",(function(){return Te})),n.d(r,"AsyncUnzipInflate",(function(){return ke})),n.d(r,"Unzip",(function(){return Me})),n.d(r,"unzip",(function(){return Ae})),n.d(r,"unzipSync",(function(){return Ee}));var o=n("2745"),i={},a=function(t){return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},s=function(t){return new Worker(t)};
/*!
fflate - fast JavaScript compression/decompression
<https://101arrowz.github.io/fflate>
Licensed under MIT. https://github.com/101arrowz/fflate/blob/master/LICENSE
version 0.6.9
*/try{URL.revokeObjectURL(a(""))}catch(un){a=function(t){return"data:application/javascript;charset=UTF-8,"+encodeURI(t)},s=function(t){return new Worker(t,{type:"module"})}}var c=function(t,e,n,r,o){var c=s(i[e]||(i[e]=a(t)));return c.onerror=function(t){return o(t.error,null)},c.onmessage=function(t){return o(null,t.data)},c.postMessage(n,r),c},l=Uint8Array,u=Uint16Array,h=Uint32Array,f=new l([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),p=new l([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),d=new l([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),g=function(t,e){for(var n=new u(31),r=0;r<31;++r)n[r]=e+=1<<t[r-1];var o=new h(n[30]);for(r=1;r<30;++r)for(var i=n[r];i<n[r+1];++i)o[i]=i-n[r]<<5|r;return[n,o]},m=g(f,2),v=m[0],y=m[1];v[28]=258,y[258]=28;for(var w=g(p,0),b=w[0],x=w[1],I=new u(32768),T=0;T<32768;++T){var k=(43690&T)>>>1|(21845&T)<<1;k=(52428&k)>>>2|(13107&k)<<2,k=(61680&k)>>>4|(3855&k)<<4,I[T]=((65280&k)>>>8|(255&k)<<8)>>>1}var M=function(t,e,n){for(var r=t.length,o=0,i=new u(e);o<r;++o)++i[t[o]-1];var a,s=new u(e);for(o=0;o<e;++o)s[o]=s[o-1]+i[o-1]<<1;if(n){a=new u(1<<e);var c=15-e;for(o=0;o<r;++o)if(t[o])for(var l=o<<4|t[o],h=e-t[o],f=s[t[o]-1]++<<h,p=f|(1<<h)-1;f<=p;++f)a[I[f]>>>c]=l}else for(a=new u(r),o=0;o<r;++o)t[o]&&(a[o]=I[s[t[o]-1]++]>>>15-t[o]);return a},A=new l(288);for(T=0;T<144;++T)A[T]=8;for(T=144;T<256;++T)A[T]=9;for(T=256;T<280;++T)A[T]=7;for(T=280;T<288;++T)A[T]=8;var E=new l(32);for(T=0;T<32;++T)E[T]=5;var D=M(A,9,0),C=M(A,9,1),P=M(E,5,0),L=M(E,5,1),F=function(t){for(var e=t[0],n=1;n<t.length;++n)t[n]>e&&(e=t[n]);return e},S=function(t,e,n){var r=e/8|0;return(t[r]|t[r+1]<<8)>>(7&e)&n},N=function(t,e){var n=e/8|0;return(t[n]|t[n+1]<<8|t[n+2]<<16)>>(7&e)},R=function(t){return(t/8|0)+(7&t&&1)},O=function(t,e,n){(null==e||e<0)&&(e=0),(null==n||n>t.length)&&(n=t.length);var r=new(t instanceof u?u:t instanceof h?h:l)(n-e);return r.set(t.subarray(e,n)),r},B=function(t,e,n){var r=t.length;if(!r||n&&!n.l&&r<5)return e||new l(0);var o=!e||n,i=!n||n.i;n||(n={}),e||(e=new l(3*r));var a=function(t){var n=e.length;if(t>n){var r=new l(Math.max(2*n,t));r.set(e),e=r}},s=n.f||0,c=n.p||0,u=n.b||0,h=n.l,g=n.d,m=n.m,y=n.n,w=8*r;do{if(!h){n.f=s=S(t,c,1);var x=S(t,c+1,3);if(c+=3,!x){var I=R(c)+4,T=t[I-4]|t[I-3]<<8,k=I+T;if(k>r){if(i)throw"unexpected EOF";break}o&&a(u+T),e.set(t.subarray(I,k),u),n.b=u+=T,n.p=c=8*k;continue}if(1==x)h=C,g=L,m=9,y=5;else{if(2!=x)throw"invalid block type";var A=S(t,c,31)+257,E=S(t,c+10,15)+4,D=A+S(t,c+5,31)+1;c+=14;for(var P=new l(D),B=new l(19),U=0;U<E;++U)B[d[U]]=S(t,c+3*U,7);c+=3*E;var z=F(B),V=(1<<z)-1,j=M(B,z,1);for(U=0;U<D;){var G=j[S(t,c,V)];c+=15&G;I=G>>>4;if(I<16)P[U++]=I;else{var X=0,W=0;16==I?(W=3+S(t,c,3),c+=2,X=P[U-1]):17==I?(W=3+S(t,c,7),c+=3):18==I&&(W=11+S(t,c,127),c+=7);while(W--)P[U++]=X}}var H=P.subarray(0,A),_=P.subarray(A);m=F(H),y=F(_),h=M(H,m,1),g=M(_,y,1)}if(c>w){if(i)throw"unexpected EOF";break}}o&&a(u+131072);for(var Z=(1<<m)-1,K=(1<<y)-1,Y=c;;Y=c){X=h[N(t,c)&Z];var q=X>>>4;if(c+=15&X,c>w){if(i)throw"unexpected EOF";break}if(!X)throw"invalid length/literal";if(q<256)e[u++]=q;else{if(256==q){Y=c,h=null;break}var Q=q-254;if(q>264){U=q-257;var $=f[U];Q=S(t,c,(1<<$)-1)+v[U],c+=$}var J=g[N(t,c)&K],tt=J>>>4;if(!J)throw"invalid distance";c+=15&J;_=b[tt];if(tt>3){$=p[tt];_+=N(t,c)&(1<<$)-1,c+=$}if(c>w){if(i)throw"unexpected EOF";break}o&&a(u+131072);for(var et=u+Q;u<et;u+=4)e[u]=e[u-_],e[u+1]=e[u+1-_],e[u+2]=e[u+2-_],e[u+3]=e[u+3-_];u=et}}n.l=h,n.p=Y,n.b=u,h&&(s=1,n.m=m,n.d=g,n.n=y)}while(!s);return u==e.length?e:O(e,0,u)},U=function(t,e,n){n<<=7&e;var r=e/8|0;t[r]|=n,t[r+1]|=n>>>8},z=function(t,e,n){n<<=7&e;var r=e/8|0;t[r]|=n,t[r+1]|=n>>>8,t[r+2]|=n>>>16},V=function(t,e){for(var n=[],r=0;r<t.length;++r)t[r]&&n.push({s:r,f:t[r]});var o=n.length,i=n.slice();if(!o)return[Z,0];if(1==o){var a=new l(n[0].s+1);return a[n[0].s]=1,[a,1]}n.sort((function(t,e){return t.f-e.f})),n.push({s:-1,f:25001});var s=n[0],c=n[1],h=0,f=1,p=2;n[0]={s:-1,f:s.f+c.f,l:s,r:c};while(f!=o-1)s=n[n[h].f<n[p].f?h++:p++],c=n[h!=f&&n[h].f<n[p].f?h++:p++],n[f++]={s:-1,f:s.f+c.f,l:s,r:c};var d=i[0].s;for(r=1;r<o;++r)i[r].s>d&&(d=i[r].s);var g=new u(d+1),m=j(n[f-1],g,0);if(m>e){r=0;var v=0,y=m-e,w=1<<y;for(i.sort((function(t,e){return g[e.s]-g[t.s]||t.f-e.f}));r<o;++r){var b=i[r].s;if(!(g[b]>e))break;v+=w-(1<<m-g[b]),g[b]=e}v>>>=y;while(v>0){var x=i[r].s;g[x]<e?v-=1<<e-g[x]++-1:++r}for(;r>=0&&v;--r){var I=i[r].s;g[I]==e&&(--g[I],++v)}m=e}return[new l(g),m]},j=function(t,e,n){return-1==t.s?Math.max(j(t.l,e,n+1),j(t.r,e,n+1)):e[t.s]=n},G=function(t){var e=t.length;while(e&&!t[--e]);for(var n=new u(++e),r=0,o=t[0],i=1,a=function(t){n[r++]=t},s=1;s<=e;++s)if(t[s]==o&&s!=e)++i;else{if(!o&&i>2){for(;i>138;i-=138)a(32754);i>2&&(a(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(a(o),--i;i>6;i-=6)a(8304);i>2&&(a(i-3<<5|8208),i=0)}while(i--)a(o);i=1,o=t[s]}return[n.subarray(0,r),e]},X=function(t,e){for(var n=0,r=0;r<e.length;++r)n+=t[r]*e[r];return n},W=function(t,e,n){var r=n.length,o=R(e+2);t[o]=255&r,t[o+1]=r>>>8,t[o+2]=255^t[o],t[o+3]=255^t[o+1];for(var i=0;i<r;++i)t[o+i+4]=n[i];return 8*(o+4+r)},H=function(t,e,n,r,o,i,a,s,c,l,h){U(e,h++,n),++o[256];for(var g=V(o,15),m=g[0],v=g[1],y=V(i,15),w=y[0],b=y[1],x=G(m),I=x[0],T=x[1],k=G(w),C=k[0],L=k[1],F=new u(19),S=0;S<I.length;++S)F[31&I[S]]++;for(S=0;S<C.length;++S)F[31&C[S]]++;for(var N=V(F,7),R=N[0],O=N[1],B=19;B>4&&!R[d[B-1]];--B);var j,H,_,Z,K=l+5<<3,Y=X(o,A)+X(i,E)+a,q=X(o,m)+X(i,w)+a+14+3*B+X(F,R)+(2*F[16]+3*F[17]+7*F[18]);if(K<=Y&&K<=q)return W(e,h,t.subarray(c,c+l));if(U(e,h,1+(q<Y)),h+=2,q<Y){j=M(m,v,0),H=m,_=M(w,b,0),Z=w;var Q=M(R,O,0);U(e,h,T-257),U(e,h+5,L-1),U(e,h+10,B-4),h+=14;for(S=0;S<B;++S)U(e,h+3*S,R[d[S]]);h+=3*B;for(var $=[I,C],J=0;J<2;++J){var tt=$[J];for(S=0;S<tt.length;++S){var et=31&tt[S];U(e,h,Q[et]),h+=R[et],et>15&&(U(e,h,tt[S]>>>5&127),h+=tt[S]>>>12)}}}else j=D,H=A,_=P,Z=E;for(S=0;S<s;++S)if(r[S]>255){et=r[S]>>>18&31;z(e,h,j[et+257]),h+=H[et+257],et>7&&(U(e,h,r[S]>>>23&31),h+=f[et]);var nt=31&r[S];z(e,h,_[nt]),h+=Z[nt],nt>3&&(z(e,h,r[S]>>>5&8191),h+=p[nt])}else z(e,h,j[r[S]]),h+=H[r[S]];return z(e,h,j[256]),h+H[256]},_=new h([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Z=new l(0),K=function(t,e,n,r,o,i){var a=t.length,s=new l(r+a+5*(1+Math.ceil(a/7e3))+o),c=s.subarray(r,s.length-o),d=0;if(!e||a<8)for(var g=0;g<=a;g+=65535){var m=g+65535;m<a?d=W(c,d,t.subarray(g,m)):(c[g]=i,d=W(c,d,t.subarray(g,a)))}else{for(var v=_[e-1],w=v>>>13,b=8191&v,I=(1<<n)-1,T=new u(32768),k=new u(I+1),M=Math.ceil(n/3),A=2*M,E=function(e){return(t[e]^t[e+1]<<M^t[e+2]<<A)&I},D=new h(25e3),C=new u(288),P=new u(32),L=0,F=0,S=(g=0,0),N=0,B=0;g<a;++g){var U=E(g),z=32767&g,V=k[U];if(T[z]=V,k[U]=z,N<=g){var j=a-g;if((L>7e3||S>24576)&&j>423){d=H(t,c,0,D,C,P,F,S,B,g-B,d),S=L=F=0,B=g;for(var G=0;G<286;++G)C[G]=0;for(G=0;G<30;++G)P[G]=0}var X=2,K=0,Y=b,q=z-V&32767;if(j>2&&U==E(g-q)){var Q=Math.min(w,j)-1,$=Math.min(32767,g),J=Math.min(258,j);while(q<=$&&--Y&&z!=V){if(t[g+X]==t[g+X-q]){for(var tt=0;tt<J&&t[g+tt]==t[g+tt-q];++tt);if(tt>X){if(X=tt,K=q,tt>Q)break;var et=Math.min(q,tt-2),nt=0;for(G=0;G<et;++G){var rt=g-q+G+32768&32767,ot=T[rt],it=rt-ot+32768&32767;it>nt&&(nt=it,V=rt)}}}z=V,V=T[z],q+=z-V+32768&32767}}if(K){D[S++]=268435456|y[X]<<18|x[K];var at=31&y[X],st=31&x[K];F+=f[at]+p[st],++C[257+at],++P[st],N=g+X,++L}else D[S++]=t[g],++C[t[g]]}}d=H(t,c,i,D,C,P,F,S,B,g-B,d),!i&&7&d&&(d=W(c,d+1,Z))}return O(s,0,r+R(d)+o)},Y=function(){for(var t=new h(256),e=0;e<256;++e){var n=e,r=9;while(--r)n=(1&n&&3988292384)^n>>>1;t[e]=n}return t}(),q=function(){var t=-1;return{p:function(e){for(var n=t,r=0;r<e.length;++r)n=Y[255&n^e[r]]^n>>>8;t=n},d:function(){return~t}}},Q=function(){var t=1,e=0;return{p:function(n){for(var r=t,o=e,i=n.length,a=0;a!=i;){for(var s=Math.min(a+2655,i);a<s;++a)o+=r+=n[a];r=(65535&r)+15*(r>>16),o=(65535&o)+15*(o>>16)}t=r,e=o},d:function(){return t%=65521,e%=65521,(255&t)<<24|t>>>8<<16|(255&e)<<8|e>>>8}}},$=function(t,e,n,r,o){return K(t,null==e.level?6:e.level,null==e.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(t.length)))):12+e.mem,n,r,!o)},J=function(t,e){var n={};for(var r in t)n[r]=t[r];for(var r in e)n[r]=e[r];return n},tt=function(t,e,n){for(var r=t(),o=t.toString(),i=o.slice(o.indexOf("[")+1,o.lastIndexOf("]")).replace(/ /g,"").split(","),a=0;a<r.length;++a){var s=r[a],c=i[a];if("function"==typeof s){e+=";"+c+"=";var l=s.toString();if(s.prototype)if(-1!=l.indexOf("[native code]")){var u=l.indexOf(" ",8)+1;e+=l.slice(u,l.indexOf("(",u))}else for(var h in e+=l,s.prototype)e+=";"+c+".prototype."+h+"="+s.prototype[h].toString();else e+=l}else n[c]=s}return[e,n]},et=[],nt=function(t){var e=[];for(var n in t)(t[n]instanceof l||t[n]instanceof u||t[n]instanceof h)&&e.push((t[n]=new t[n].constructor(t[n])).buffer);return e},rt=function(t,e,n,r){var o;if(!et[n]){for(var i="",a={},s=t.length-1,l=0;l<s;++l)o=tt(t[l],i,a),i=o[0],a=o[1];et[n]=tt(t[s],i,a)}var u=J({},et[n][1]);return c(et[n][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+e.toString()+"}",n,u,nt(u),r)},ot=function(){return[l,u,h,f,p,d,v,b,C,L,I,M,F,S,N,R,O,B,St,ut,ht]},it=function(){return[l,u,h,f,p,d,y,x,D,A,P,E,I,_,Z,M,U,z,V,j,G,X,W,H,R,O,K,$,Ct,ut]},at=function(){return[wt,It,yt,q,Y]},st=function(){return[bt,xt]},ct=function(){return[Tt,yt,Q]},lt=function(){return[kt]},ut=function(t){return postMessage(t,[t.buffer])},ht=function(t){return t&&t.size&&new l(t.size)},ft=function(t,e,n,r,o,i){var a=rt(n,r,o,(function(t,e){a.terminate(),i(t,e)}));return a.postMessage([t,e],e.consume?[t.buffer]:[]),function(){a.terminate()}},pt=function(t){return t.ondata=function(t,e){return postMessage([t,e],[t.buffer])},function(e){return t.push(e.data[0],e.data[1])}},dt=function(t,e,n,r,o){var i,a=rt(t,r,o,(function(t,n){t?(a.terminate(),e.ondata.call(e,t)):(n[1]&&a.terminate(),e.ondata.call(e,t,n[0],n[1]))}));a.postMessage(n),e.push=function(t,n){if(i)throw"stream finished";if(!e.ondata)throw"no stream handler";a.postMessage([t,i=n],[t.buffer])},e.terminate=function(){a.terminate()}},gt=function(t,e){return t[e]|t[e+1]<<8},mt=function(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0},vt=function(t,e){return mt(t,e)+4294967296*mt(t,e+4)},yt=function(t,e,n){for(;n;++e)t[e]=n,n>>>=8},wt=function(t,e){var n=e.filename;if(t[0]=31,t[1]=139,t[2]=8,t[8]=e.level<2?4:9==e.level?2:0,t[9]=3,0!=e.mtime&&yt(t,4,Math.floor(new Date(e.mtime||Date.now())/1e3)),n){t[3]=8;for(var r=0;r<=n.length;++r)t[r+10]=n.charCodeAt(r)}},bt=function(t){if(31!=t[0]||139!=t[1]||8!=t[2])throw"invalid gzip data";var e=t[3],n=10;4&e&&(n+=t[10]|2+(t[11]<<8));for(var r=(e>>3&1)+(e>>4&1);r>0;r-=!t[n++]);return n+(2&e)},xt=function(t){var e=t.length;return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0},It=function(t){return 10+(t.filename&&t.filename.length+1||0)},Tt=function(t,e){var n=e.level,r=0==n?0:n<6?1:9==n?3:2;t[0]=120,t[1]=r<<6|(r?32-2*r:1)},kt=function(t){if(8!=(15&t[0])||t[0]>>>4>7||(t[0]<<8|t[1])%31)throw"invalid zlib data";if(32&t[1])throw"invalid zlib data: preset dictionaries not supported"};function Mt(t,e){return e||"function"!=typeof t||(e=t,t={}),this.ondata=e,t}var At=function(){function t(t,e){e||"function"!=typeof t||(e=t,t={}),this.ondata=e,this.o=t||{}}return t.prototype.p=function(t,e){this.ondata($(t,this.o,0,0,!e),e)},t.prototype.push=function(t,e){if(this.d)throw"stream finished";if(!this.ondata)throw"no stream handler";this.d=e,this.p(t,e||!1)},t}(),Et=function(){function t(t,e){dt([it,function(){return[pt,At]}],this,Mt.call(this,t,e),(function(t){var e=new At(t.data);onmessage=pt(e)}),6)}return t}();function Dt(t,e,n){if(n||(n=e,e={}),"function"!=typeof n)throw"no callback";return ft(t,e,[it],(function(t){return ut(Ct(t.data[0],t.data[1]))}),0,n)}function Ct(t,e){return $(t,e||{},0,0)}var Pt=function(){function t(t){this.s={},this.p=new l(0),this.ondata=t}return t.prototype.e=function(t){if(this.d)throw"stream finished";if(!this.ondata)throw"no stream handler";var e=this.p.length,n=new l(e+t.length);n.set(this.p),n.set(t,e),this.p=n},t.prototype.c=function(t){this.d=this.s.i=t||!1;var e=this.s.b,n=B(this.p,this.o,this.s);this.ondata(O(n,e,this.s.b),this.d),this.o=O(n,this.s.b-32768),this.s.b=this.o.length,this.p=O(this.p,this.s.p/8|0),this.s.p&=7},t.prototype.push=function(t,e){this.e(t),this.c(e)},t}(),Lt=function(){function t(t){this.ondata=t,dt([ot,function(){return[pt,Pt]}],this,0,(function(){var t=new Pt;onmessage=pt(t)}),7)}return t}();function Ft(t,e,n){if(n||(n=e,e={}),"function"!=typeof n)throw"no callback";return ft(t,e,[ot],(function(t){return ut(St(t.data[0],ht(t.data[1])))}),1,n)}function St(t,e){return B(t,e)}var Nt=function(){function t(t,e){this.c=q(),this.l=0,this.v=1,At.call(this,t,e)}return t.prototype.push=function(t,e){At.prototype.push.call(this,t,e)},t.prototype.p=function(t,e){this.c.p(t),this.l+=t.length;var n=$(t,this.o,this.v&&It(this.o),e&&8,!e);this.v&&(wt(n,this.o),this.v=0),e&&(yt(n,n.length-8,this.c.d()),yt(n,n.length-4,this.l)),this.ondata(n,e)},t}(),Rt=function(){function t(t,e){dt([it,at,function(){return[pt,At,Nt]}],this,Mt.call(this,t,e),(function(t){var e=new Nt(t.data);onmessage=pt(e)}),8)}return t}();function Ot(t,e,n){if(n||(n=e,e={}),"function"!=typeof n)throw"no callback";return ft(t,e,[it,at,function(){return[Bt]}],(function(t){return ut(Bt(t.data[0],t.data[1]))}),2,n)}function Bt(t,e){e||(e={});var n=q(),r=t.length;n.p(t);var o=$(t,e,It(e),8),i=o.length;return wt(o,e),yt(o,i-8,n.d()),yt(o,i-4,r),o}var Ut=function(){function t(t){this.v=1,Pt.call(this,t)}return t.prototype.push=function(t,e){if(Pt.prototype.e.call(this,t),this.v){var n=this.p.length>3?bt(this.p):4;if(n>=this.p.length&&!e)return;this.p=this.p.subarray(n),this.v=0}if(e){if(this.p.length<8)throw"invalid gzip stream";this.p=this.p.subarray(0,-8)}Pt.prototype.c.call(this,e)},t}(),zt=function(){function t(t){this.ondata=t,dt([ot,st,function(){return[pt,Pt,Ut]}],this,0,(function(){var t=new Ut;onmessage=pt(t)}),9)}return t}();function Vt(t,e,n){if(n||(n=e,e={}),"function"!=typeof n)throw"no callback";return ft(t,e,[ot,st,function(){return[jt]}],(function(t){return ut(jt(t.data[0]))}),3,n)}function jt(t,e){return B(t.subarray(bt(t),-8),e||new l(xt(t)))}var Gt=function(){function t(t,e){this.c=Q(),this.v=1,At.call(this,t,e)}return t.prototype.push=function(t,e){At.prototype.push.call(this,t,e)},t.prototype.p=function(t,e){this.c.p(t);var n=$(t,this.o,this.v&&2,e&&4,!e);this.v&&(Tt(n,this.o),this.v=0),e&&yt(n,n.length-4,this.c.d()),this.ondata(n,e)},t}(),Xt=function(){function t(t,e){dt([it,ct,function(){return[pt,At,Gt]}],this,Mt.call(this,t,e),(function(t){var e=new Gt(t.data);onmessage=pt(e)}),10)}return t}();function Wt(t,e,n){if(n||(n=e,e={}),"function"!=typeof n)throw"no callback";return ft(t,e,[it,ct,function(){return[Ht]}],(function(t){return ut(Ht(t.data[0],t.data[1]))}),4,n)}function Ht(t,e){e||(e={});var n=Q();n.p(t);var r=$(t,e,2,4);return Tt(r,e),yt(r,r.length-4,n.d()),r}var _t=function(){function t(t){this.v=1,Pt.call(this,t)}return t.prototype.push=function(t,e){if(Pt.prototype.e.call(this,t),this.v){if(this.p.length<2&&!e)return;this.p=this.p.subarray(2),this.v=0}if(e){if(this.p.length<4)throw"invalid zlib stream";this.p=this.p.subarray(0,-4)}Pt.prototype.c.call(this,e)},t}(),Zt=function(){function t(t){this.ondata=t,dt([ot,lt,function(){return[pt,Pt,_t]}],this,0,(function(){var t=new _t;onmessage=pt(t)}),11)}return t}();function Kt(t,e,n){if(n||(n=e,e={}),"function"!=typeof n)throw"no callback";return ft(t,e,[ot,lt,function(){return[Yt]}],(function(t){return ut(Yt(t.data[0],ht(t.data[1])))}),5,n)}function Yt(t,e){return B((kt(t),t.subarray(2,-4)),e)}var qt=function(){function t(t){this.G=Ut,this.I=Pt,this.Z=_t,this.ondata=t}return t.prototype.push=function(t,e){if(!this.ondata)throw"no stream handler";if(this.s)this.s.push(t,e);else{if(this.p&&this.p.length){var n=new l(this.p.length+t.length);n.set(this.p),n.set(t,this.p.length)}else this.p=t;if(this.p.length>2){var r=this,o=function(){r.ondata.apply(r,arguments)};this.s=31==this.p[0]&&139==this.p[1]&&8==this.p[2]?new this.G(o):8!=(15&this.p[0])||this.p[0]>>4>7||(this.p[0]<<8|this.p[1])%31?new this.I(o):new this.Z(o),this.s.push(this.p,e),this.p=null}}},t}(),Qt=function(){function t(t){this.G=zt,this.I=Lt,this.Z=Zt,this.ondata=t}return t.prototype.push=function(t,e){qt.prototype.push.call(this,t,e)},t}();function $t(t,e,n){if(n||(n=e,e={}),"function"!=typeof n)throw"no callback";return 31==t[0]&&139==t[1]&&8==t[2]?Vt(t,e,n):8!=(15&t[0])||t[0]>>4>7||(t[0]<<8|t[1])%31?Ft(t,e,n):Kt(t,e,n)}function Jt(t,e){return 31==t[0]&&139==t[1]&&8==t[2]?jt(t,e):8!=(15&t[0])||t[0]>>4>7||(t[0]<<8|t[1])%31?St(t,e):Yt(t,e)}var te=function(t,e,n,r){for(var o in t){var i=t[o],a=e+o;i instanceof l?n[a]=[i,r]:Array.isArray(i)?n[a]=[i[0],J(r,i[1])]:te(i,a+"/",n,r)}},ee="undefined"!=typeof TextEncoder&&new TextEncoder,ne="undefined"!=typeof TextDecoder&&new TextDecoder,re=0;try{ne.decode(Z,{stream:!0}),re=1}catch(un){}var oe=function(t){for(var e="",n=0;;){var r=t[n++],o=(r>127)+(r>223)+(r>239);if(n+o>t.length)return[e,O(t,n-1)];o?3==o?(r=((15&r)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536,e+=String.fromCharCode(55296|r>>10,56320|1023&r)):e+=1&o?String.fromCharCode((31&r)<<6|63&t[n++]):String.fromCharCode((15&r)<<12|(63&t[n++])<<6|63&t[n++]):e+=String.fromCharCode(r)}},ie=function(){function t(t){this.ondata=t,re?this.t=new TextDecoder:this.p=Z}return t.prototype.push=function(t,e){if(!this.ondata)throw"no callback";if(e=!!e,this.t){if(this.ondata(this.t.decode(t,{stream:!0}),e),e){if(this.t.decode().length)throw"invalid utf-8 data";this.t=null}}else{if(!this.p)throw"stream finished";var n=new l(this.p.length+t.length);n.set(this.p),n.set(t,this.p.length);var r=oe(n),o=r[0],i=r[1];if(e){if(i.length)throw"invalid utf-8 data";this.p=null}else this.p=i;this.ondata(o,e)}},t}(),ae=function(){function t(t){this.ondata=t}return t.prototype.push=function(t,e){if(!this.ondata)throw"no callback";if(this.d)throw"stream finished";this.ondata(se(t),this.d=e||!1)},t}();function se(t,e){if(e){for(var n=new l(t.length),r=0;r<t.length;++r)n[r]=t.charCodeAt(r);return n}if(ee)return ee.encode(t);var o=t.length,i=new l(t.length+(t.length>>1)),a=0,s=function(t){i[a++]=t};for(r=0;r<o;++r){if(a+5>i.length){var c=new l(a+8+(o-r<<1));c.set(i),i=c}var u=t.charCodeAt(r);u<128||e?s(u):u<2048?(s(192|u>>6),s(128|63&u)):u>55295&&u<57344?(u=65536+(1047552&u)|1023&t.charCodeAt(++r),s(240|u>>18),s(128|u>>12&63),s(128|u>>6&63),s(128|63&u)):(s(224|u>>12),s(128|u>>6&63),s(128|63&u))}return O(i,0,a)}function ce(t,e){if(e){for(var n="",r=0;r<t.length;r+=16384)n+=String.fromCharCode.apply(null,t.subarray(r,r+16384));return n}if(ne)return ne.decode(t);var o=oe(t),i=o[0],a=o[1];if(a.length)throw"invalid utf-8 data";return i}var le=function(t){return 1==t?3:t<6?2:9==t?1:0},ue=function(t,e){return e+30+gt(t,e+26)+gt(t,e+28)},he=function(t,e,n){var r=gt(t,e+28),o=ce(t.subarray(e+46,e+46+r),!(2048&gt(t,e+8))),i=e+46+r,a=mt(t,e+20),s=n&&4294967295==a?fe(t,i):[a,mt(t,e+24),mt(t,e+42)],c=s[0],l=s[1],u=s[2];return[gt(t,e+10),c,l,o,i+gt(t,e+30)+gt(t,e+32),u]},fe=function(t,e){for(;1!=gt(t,e);e+=4+gt(t,e+2));return[vt(t,e+12),vt(t,e+4),vt(t,e+20)]},pe=function(t){var e=0;if(t)for(var n in t){var r=t[n].length;if(r>65535)throw"extra field too long";e+=r+4}return e},de=function(t,e,n,r,o,i,a,s){var c=r.length,l=n.extra,u=s&&s.length,h=pe(l);yt(t,e,null!=a?33639248:67324752),e+=4,null!=a&&(t[e++]=20,t[e++]=n.os),t[e]=20,e+=2,t[e++]=n.flag<<1|(null==i&&8),t[e++]=o&&8,t[e++]=255&n.compression,t[e++]=n.compression>>8;var f=new Date(null==n.mtime?Date.now():n.mtime),p=f.getFullYear()-1980;if(p<0||p>119)throw"date not in range 1980-2099";if(yt(t,e,p<<25|f.getMonth()+1<<21|f.getDate()<<16|f.getHours()<<11|f.getMinutes()<<5|f.getSeconds()>>>1),e+=4,null!=i&&(yt(t,e,n.crc),yt(t,e+4,i),yt(t,e+8,n.size)),yt(t,e+12,c),yt(t,e+14,h),e+=16,null!=a&&(yt(t,e,u),yt(t,e+6,n.attrs),yt(t,e+10,a),e+=14),t.set(r,e),e+=c,h)for(var d in l){var g=l[d],m=g.length;yt(t,e,+d),yt(t,e+2,m),t.set(g,e+4),e+=4+m}return u&&(t.set(s,e),e+=u),e},ge=function(t,e,n,r,o){yt(t,e,101010256),yt(t,e+8,n),yt(t,e+10,n),yt(t,e+12,r),yt(t,e+16,o)},me=function(){function t(t){this.filename=t,this.c=q(),this.size=0,this.compression=0}return t.prototype.process=function(t,e){this.ondata(null,t,e)},t.prototype.push=function(t,e){if(!this.ondata)throw"no callback - add to ZIP archive before pushing";this.c.p(t),this.size+=t.length,e&&(this.crc=this.c.d()),this.process(t,e||!1)},t}(),ve=function(){function t(t,e){var n=this;e||(e={}),me.call(this,t),this.d=new At(e,(function(t,e){n.ondata(null,t,e)})),this.compression=8,this.flag=le(e.level)}return t.prototype.process=function(t,e){try{this.d.push(t,e)}catch(un){this.ondata(un,null,e)}},t.prototype.push=function(t,e){me.prototype.push.call(this,t,e)},t}(),ye=function(){function t(t,e){var n=this;e||(e={}),me.call(this,t),this.d=new Et(e,(function(t,e,r){n.ondata(t,e,r)})),this.compression=8,this.flag=le(e.level),this.terminate=this.d.terminate}return t.prototype.process=function(t,e){this.d.push(t,e)},t.prototype.push=function(t,e){me.prototype.push.call(this,t,e)},t}(),we=function(){function t(t){this.ondata=t,this.u=[],this.d=1}return t.prototype.add=function(t){var e=this;if(2&this.d)throw"stream finished";var n=se(t.filename),r=n.length,o=t.comment,i=o&&se(o),a=r!=t.filename.length||i&&o.length!=i.length,s=r+pe(t.extra)+30;if(r>65535)throw"filename too long";var c=new l(s);de(c,0,t,n,a);var u=[c],h=function(){for(var t=0,n=u;t<n.length;t++){var r=n[t];e.ondata(null,r,!1)}u=[]},f=this.d;this.d=0;var p=this.u.length,d=J(t,{f:n,u:a,o:i,t:function(){t.terminate&&t.terminate()},r:function(){if(h(),f){var t=e.u[p+1];t?t.r():e.d=1}f=1}}),g=0;t.ondata=function(n,r,o){if(n)e.ondata(n,r,o),e.terminate();else if(g+=r.length,u.push(r),o){var i=new l(16);yt(i,0,134695760),yt(i,4,t.crc),yt(i,8,g),yt(i,12,t.size),u.push(i),d.c=g,d.b=s+g+16,d.crc=t.crc,d.size=t.size,f&&d.r(),f=1}else f&&h()},this.u.push(d)},t.prototype.end=function(){var t=this;if(2&this.d){if(1&this.d)throw"stream finishing";throw"stream finished"}this.d?this.e():this.u.push({r:function(){1&t.d&&(t.u.splice(-1,1),t.e())},t:function(){}}),this.d=3},t.prototype.e=function(){for(var t=0,e=0,n=0,r=0,o=this.u;r<o.length;r++){var i=o[r];n+=46+i.f.length+pe(i.extra)+(i.o?i.o.length:0)}for(var a=new l(n+22),s=0,c=this.u;s<c.length;s++){i=c[s];de(a,t,i,i.f,i.u,i.c,e,i.o),t+=46+i.f.length+pe(i.extra)+(i.o?i.o.length:0),e+=i.b}ge(a,t,this.u.length,n,e),this.ondata(null,a,!0),this.d=2},t.prototype.terminate=function(){for(var t=0,e=this.u;t<e.length;t++){var n=e[t];n.t()}this.d=2},t}();function be(t,e,n){if(n||(n=e,e={}),"function"!=typeof n)throw"no callback";var r={};te(t,"",r,e);var o=Object.keys(r),i=o.length,a=0,s=0,c=i,u=new Array(i),h=[],f=function(){for(var t=0;t<h.length;++t)h[t]()},p=function(){var t=new l(s+22),e=a,r=s-a;s=0;for(var o=0;o<c;++o){var i=u[o];try{var h=i.c.length;de(t,s,i,i.f,i.u,h);var f=30+i.f.length+pe(i.extra),p=s+f;t.set(i.c,p),de(t,a,i,i.f,i.u,h,s,i.m),a+=16+f+(i.m?i.m.length:0),s=p+h}catch(un){return n(un,null)}}ge(t,a,u.length,r,e),n(null,t)};i||p();for(var d=function(t){var e=o[t],c=r[e],l=c[0],d=c[1],g=q(),m=l.length;g.p(l);var v=se(e),y=v.length,w=d.comment,b=w&&se(w),x=b&&b.length,I=pe(d.extra),T=0==d.level?0:8,k=function(r,o){if(r)f(),n(r,null);else{var c=o.length;u[t]=J(d,{size:m,crc:g.d(),c:o,f:v,m:b,u:y!=e.length||b&&w.length!=x,compression:T}),a+=30+y+I+c,s+=76+2*(y+I)+(x||0)+c,--i||p()}};if(y>65535&&k("filename too long",null),T)if(m<16e4)try{k(null,Ct(l,d))}catch(un){k(un,null)}else h.push(Dt(l,d,k));else k(null,l)},g=0;g<c;++g)d(g);return f}function xe(t,e){e||(e={});var n={},r=[];te(t,"",n,e);var o=0,i=0;for(var a in n){var s=n[a],c=s[0],u=s[1],h=0==u.level?0:8,f=se(a),p=f.length,d=u.comment,g=d&&se(d),m=g&&g.length,v=pe(u.extra);if(p>65535)throw"filename too long";var y=h?Ct(c,u):c,w=y.length,b=q();b.p(c),r.push(J(u,{size:c.length,crc:b.d(),c:y,f:f,m:g,u:p!=a.length||g&&d.length!=m,o:o,compression:h})),o+=30+p+v+w,i+=76+2*(p+v)+(m||0)+w}for(var x=new l(i+22),I=o,T=i-o,k=0;k<r.length;++k){f=r[k];de(x,f.o,f,f.f,f.u,f.c.length);var M=30+f.f.length+pe(f.extra);x.set(f.c,f.o+M),de(x,o,f,f.f,f.u,f.c.length,f.o,f.m),o+=16+M+(f.m?f.m.length:0)}return ge(x,o,r.length,T,I),x}var Ie=function(){function t(){}return t.prototype.push=function(t,e){this.ondata(null,t,e)},t.compression=0,t}(),Te=function(){function t(){var t=this;this.i=new Pt((function(e,n){t.ondata(null,e,n)}))}return t.prototype.push=function(t,e){try{this.i.push(t,e)}catch(un){this.ondata(un,t,e)}},t.compression=8,t}(),ke=function(){function t(t,e){var n=this;e<32e4?this.i=new Pt((function(t,e){n.ondata(null,t,e)})):(this.i=new Lt((function(t,e,r){n.ondata(t,e,r)})),this.terminate=this.i.terminate)}return t.prototype.push=function(t,e){this.i.terminate&&(t=O(t,0)),this.i.push(t,e)},t.compression=8,t}(),Me=function(){function t(t){this.onfile=t,this.k=[],this.o={0:Ie},this.p=Z}return t.prototype.push=function(t,e){var n=this;if(!this.onfile)throw"no callback";if(!this.p)throw"stream finished";if(this.c>0){var r=Math.min(this.c,t.length),o=t.subarray(0,r);if(this.c-=r,this.d?this.d.push(o,!this.c):this.k[0].push(o),t=t.subarray(r),t.length)return this.push(t,e)}else{var i=0,a=0,s=void 0,c=void 0;this.p.length?t.length?(c=new l(this.p.length+t.length),c.set(this.p),c.set(t,this.p.length)):c=this.p:c=t;for(var u=c.length,h=this.c,f=h&&this.d,p=function(){var t,e=mt(c,a);if(67324752==e){i=1,s=a,d.d=null,d.c=0;var r=gt(c,a+6),o=gt(c,a+8),l=2048&r,f=8&r,p=gt(c,a+26),g=gt(c,a+28);if(u>a+30+p+g){var m=[];d.k.unshift(m),i=2;var v,y=mt(c,a+18),w=mt(c,a+22),b=ce(c.subarray(a+30,a+=30+p),!l);4294967295==y?(t=f?[-2]:fe(c,a),y=t[0],w=t[1]):f&&(y=-1),a+=g,d.c=y;var x={name:b,compression:o,start:function(){if(!x.ondata)throw"no callback";if(y){var t=n.o[o];if(!t)throw"unknown compression type "+o;v=y<0?new t(b):new t(b,y,w),v.ondata=function(t,e,n){x.ondata(t,e,n)};for(var e=0,r=m;e<r.length;e++){var i=r[e];v.push(i,!1)}n.k[0]==m&&n.c?n.d=v:v.push(Z,!0)}else x.ondata(null,Z,!0)},terminate:function(){v&&v.terminate&&v.terminate()}};y>=0&&(x.size=y,x.originalSize=w),d.onfile(x)}return"break"}if(h){if(134695760==e)return s=a+=12+(-2==h&&8),i=3,d.c=0,"break";if(33639248==e)return s=a-=4,i=3,d.c=0,"break"}},d=this;a<u-4;++a){var g=p();if("break"===g)break}if(this.p=Z,h<0){var m=i?c.subarray(0,s-12-(-2==h&&8)-(134695760==mt(c,s-16)&&4)):c.subarray(0,a);f?f.push(m,!!i):this.k[+(2==i)].push(m)}if(2&i)return this.push(c.subarray(a),e);this.p=c.subarray(a)}if(e){if(this.c)throw"invalid zip file";this.p=null}},t.prototype.register=function(t){this.o[t.compression]=t},t}();function Ae(t,e){if("function"!=typeof e)throw"no callback";for(var n=[],r=function(){for(var t=0;t<n.length;++t)n[t]()},o={},i=t.length-22;101010256!=mt(t,i);--i)if(!i||t.length-i>65558)return void e("invalid zip file",null);var a=gt(t,i+8);a||e(null,{});var s=a,c=mt(t,i+16),u=4294967295==c;if(u){if(i=mt(t,i-12),101075792!=mt(t,i))return void e("invalid zip file",null);s=a=mt(t,i+32),c=mt(t,i+48)}for(var h=function(s){var h=he(t,c,u),f=h[0],p=h[1],d=h[2],g=h[3],m=h[4],v=h[5],y=ue(t,v);c=m;var w=function(t,n){t?(r(),e(t,null)):(o[g]=n,--a||e(null,o))};if(f)if(8==f){var b=t.subarray(y,y+p);if(p<32e4)try{w(null,St(b,new l(d)))}catch(i){w(i,null)}else n.push(Ft(b,{size:d},w))}else w("unknown compression type "+f,null);else w(null,O(t,y,y+p))},f=0;f<s;++f)h(f);return r}function Ee(t){for(var e={},n=t.length-22;101010256!=mt(t,n);--n)if(!n||t.length-n>65558)throw"invalid zip file";var r=gt(t,n+8);if(!r)return{};var o=mt(t,n+16),i=4294967295==o;if(i){if(n=mt(t,n-12),101075792!=mt(t,n))throw"invalid zip file";r=mt(t,n+32),o=mt(t,n+48)}for(var a=0;a<r;++a){var s=he(t,o,i),c=s[0],u=s[1],h=s[2],f=s[3],p=s[4],d=s[5],g=ue(t,d);if(o=p,c){if(8!=c)throw"unknown compression type "+c;e[f]=St(t.subarray(g,g+u),new l(h))}else e[f]=O(t,g,g+u)}return e}function De(t,e,n){const r=n.length-t-1;if(e>=n[r])return r-1;if(e<=n[t])return t;let o=t,i=r,a=Math.floor((o+i)/2);while(e<n[a]||e>=n[a+1])e<n[a]?i=a:o=a,a=Math.floor((o+i)/2);return a}function Ce(t,e,n,r){const o=[],i=[],a=[];o[0]=1;for(let s=1;s<=n;++s){i[s]=e-r[t+1-s],a[s]=r[t+s]-e;let n=0;for(let t=0;t<s;++t){const e=a[t+1],r=i[s-t],c=o[t]/(e+r);o[t]=n+e*c,n=r*c}o[s]=n}return o}function Pe(t,e,n,r){const i=De(t,r,e),a=Ce(i,r,t,e),s=new o["Vector4"](0,0,0,0);for(let o=0;o<=t;++o){const e=n[i-t+o],r=a[o],c=e.w*r;s.x+=e.x*c,s.y+=e.y*c,s.z+=e.z*c,s.w+=e.w*r}return s}function Le(t,e,n,r,o){const i=[];for(let h=0;h<=n;++h)i[h]=0;const a=[];for(let h=0;h<=r;++h)a[h]=i.slice(0);const s=[];for(let h=0;h<=n;++h)s[h]=i.slice(0);s[0][0]=1;const c=i.slice(0),l=i.slice(0);for(let h=1;h<=n;++h){c[h]=e-o[t+1-h],l[h]=o[t+h]-e;let n=0;for(let t=0;t<h;++t){const e=l[t+1],r=c[h-t];s[h][t]=e+r;const o=s[t][h-1]/s[h][t];s[t][h]=n+e*o,n=r*o}s[h][h]=n}for(let h=0;h<=n;++h)a[0][h]=s[h][n];for(let h=0;h<=n;++h){let t=0,e=1;const o=[];for(let r=0;r<=n;++r)o[r]=i.slice(0);o[0][0]=1;for(let i=1;i<=r;++i){let r=0;const c=h-i,l=n-i;h>=i&&(o[e][0]=o[t][0]/s[l+1][c],r=o[e][0]*s[c][l]);const u=c>=-1?1:-c,f=h-1<=l?i-1:n-h;for(let n=u;n<=f;++n)o[e][n]=(o[t][n]-o[t][n-1])/s[l+1][c+n],r+=o[e][n]*s[c+n][l];h<=l&&(o[e][i]=-o[t][i-1]/s[l+1][h],r+=o[e][i]*s[h][l]),a[i][h]=r;const p=t;t=e,e=p}}let u=n;for(let h=1;h<=r;++h){for(let t=0;t<=n;++t)a[h][t]*=u;u*=n-h}return a}function Fe(t,e,n,r,i){const a=i<t?i:t,s=[],c=De(t,r,e),l=Le(c,r,t,a,e),u=[];for(let o=0;o<n.length;++o){const t=n[o].clone(),e=t.w;t.x*=e,t.y*=e,t.z*=e,u[o]=t}for(let o=0;o<=a;++o){const e=u[c-t].clone().multiplyScalar(l[o][0]);for(let n=1;n<=t;++n)e.add(u[c-t+n].clone().multiplyScalar(l[o][n]));s[o]=e}for(let h=a+1;h<=i+1;++h)s[h]=new o["Vector4"](0,0,0);return s}function Se(t,e){let n=1;for(let o=2;o<=t;++o)n*=o;let r=1;for(let o=2;o<=e;++o)r*=o;for(let o=2;o<=t-e;++o)r*=o;return n/r}function Ne(t){const e=t.length,n=[],r=[];for(let a=0;a<e;++a){const e=t[a];n[a]=new o["Vector3"](e.x,e.y,e.z),r[a]=e.w}const i=[];for(let o=0;o<e;++o){const t=n[o].clone();for(let e=1;e<=o;++e)t.sub(i[o-e].clone().multiplyScalar(Se(o,e)*r[e]));i[o]=t.divideScalar(r[0])}return i}function Re(t,e,n,r,o){const i=Fe(t,e,n,r,o);return Ne(i)}class Oe extends o["Curve"]{constructor(t,e,n,r,i){super(),this.degree=t,this.knots=e,this.controlPoints=[],this.startKnot=r||0,this.endKnot=i||this.knots.length-1;for(let a=0;a<n.length;++a){const t=n[a];this.controlPoints[a]=new o["Vector4"](t.x,t.y,t.z,t.w)}}getPoint(t,e=new o["Vector3"]){const n=e,r=this.knots[this.startKnot]+t*(this.knots[this.endKnot]-this.knots[this.startKnot]),i=Pe(this.degree,this.knots,this.controlPoints,r);return 1!==i.w&&i.divideScalar(i.w),n.set(i.x,i.y,i.z)}getTangent(t,e=new o["Vector3"]){const n=e,r=this.knots[0]+t*(this.knots[this.knots.length-1]-this.knots[0]),i=Re(this.degree,this.knots,this.controlPoints,r,1);return n.copy(i[1]).normalize(),n}}let Be,Ue,ze;class Ve extends o["Loader"]{constructor(t){super(t)}load(t,e,n,r){const i=this,a=""===i.path?o["LoaderUtils"].extractUrlBase(t):i.path,s=new o["FileLoader"](this.manager);s.setPath(i.path),s.setResponseType("arraybuffer"),s.setRequestHeader(i.requestHeader),s.setWithCredentials(i.withCredentials),s.load(t,(function(n){try{e(i.parse(n,a))}catch(un){r?r(un):console.error(un),i.manager.itemError(t)}}),n,r)}parse(t,e){if(Ke(t))Be=(new He).parse(t);else{const e=an(t);if(!Ye(e))throw new Error("THREE.FBXLoader: Unknown format.");if(qe(e)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+qe(e));Be=(new We).parse(e)}const n=new o["TextureLoader"](this.manager).setPath(this.resourcePath||e).setCrossOrigin(this.crossOrigin);return new je(n,this.manager).parse(Be)}}class je{constructor(t,e){this.textureLoader=t,this.manager=e}parse(){Ue=this.parseConnections();const t=this.parseImages(),e=this.parseTextures(t),n=this.parseMaterials(e),r=this.parseDeformers(),o=(new Ge).parse(r);return this.parseScene(r,o,n),ze}parseConnections(){const t=new Map;if("Connections"in Be){const e=Be.Connections.connections;e.forEach((function(e){const n=e[0],r=e[1],o=e[2];t.has(n)||t.set(n,{parents:[],children:[]});const i={ID:r,relationship:o};t.get(n).parents.push(i),t.has(r)||t.set(r,{parents:[],children:[]});const a={ID:n,relationship:o};t.get(r).children.push(a)}))}return t}parseImages(){const t={},e={};if("Video"in Be.Objects){const n=Be.Objects.Video;for(const r in n){const o=n[r],i=parseInt(r);if(t[i]=o.RelativeFilename||o.Filename,"Content"in o){const t=o.Content instanceof ArrayBuffer&&o.Content.byteLength>0,i="string"===typeof o.Content&&""!==o.Content;if(t||i){const t=this.parseImage(n[r]);e[o.RelativeFilename||o.Filename]=t}}}}for(const n in t){const r=t[n];void 0!==e[r]?t[n]=e[r]:t[n]=t[n].split("\\").pop()}return t}parseImage(t){const e=t.Content,n=t.RelativeFilename||t.Filename,r=n.slice(n.lastIndexOf(".")+1).toLowerCase();let o;switch(r){case"bmp":o="image/bmp";break;case"jpg":case"jpeg":o="image/jpeg";break;case"png":o="image/png";break;case"tif":o="image/tiff";break;case"tga":null===this.manager.getHandler(".tga")&&console.warn("FBXLoader: TGA loader not found, skipping ",n),o="image/tga";break;default:return void console.warn('FBXLoader: Image type "'+r+'" is not supported.')}if("string"===typeof e)return"data:"+o+";base64,"+e;{const t=new Uint8Array(e);return window.URL.createObjectURL(new Blob([t],{type:o}))}}parseTextures(t){const e=new Map;if("Texture"in Be.Objects){const n=Be.Objects.Texture;for(const r in n){const o=this.parseTexture(n[r],t);e.set(parseInt(r),o)}}return e}parseTexture(t,e){const n=this.loadTexture(t,e);n.ID=t.id,n.name=t.attrName;const r=t.WrapModeU,i=t.WrapModeV,a=void 0!==r?r.value:0,s=void 0!==i?i.value:0;if(n.wrapS=0===a?o["RepeatWrapping"]:o["ClampToEdgeWrapping"],n.wrapT=0===s?o["RepeatWrapping"]:o["ClampToEdgeWrapping"],"Scaling"in t){const e=t.Scaling.value;n.repeat.x=e[0],n.repeat.y=e[1]}if("Translation"in t){const e=t.Translation.value;n.offset.x=e[0],n.offset.y=e[1]}return n}loadTexture(t,e){let n;const r=this.textureLoader.path,i=Ue.get(t.id).children;let a;void 0!==i&&i.length>0&&void 0!==e[i[0].ID]&&(n=e[i[0].ID],0!==n.indexOf("blob:")&&0!==n.indexOf("data:")||this.textureLoader.setPath(void 0));const s=t.FileName.slice(-3).toLowerCase();if("tga"===s){const e=this.manager.getHandler(".tga");null===e?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",t.RelativeFilename),a=new o["Texture"]):(e.setPath(this.textureLoader.path),a=e.load(n))}else"psd"===s?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",t.RelativeFilename),a=new o["Texture"]):a=this.textureLoader.load(n);return this.textureLoader.setPath(r),a}parseMaterials(t){const e=new Map;if("Material"in Be.Objects){const n=Be.Objects.Material;for(const r in n){const o=this.parseMaterial(n[r],t);null!==o&&e.set(parseInt(r),o)}}return e}parseMaterial(t,e){const n=t.id,r=t.attrName;let i=t.ShadingModel;if("object"===typeof i&&(i=i.value),!Ue.has(n))return null;const a=this.parseParameters(t,e,n);let s;switch(i.toLowerCase()){case"phong":s=new o["MeshPhongMaterial"];break;case"lambert":s=new o["MeshLambertMaterial"];break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',i),s=new o["MeshPhongMaterial"];break}return s.setValues(a),s.name=r,s}parseParameters(t,e,n){const r={};t.BumpFactor&&(r.bumpScale=t.BumpFactor.value),t.Diffuse?r.color=(new o["Color"]).fromArray(t.Diffuse.value):!t.DiffuseColor||"Color"!==t.DiffuseColor.type&&"ColorRGB"!==t.DiffuseColor.type||(r.color=(new o["Color"]).fromArray(t.DiffuseColor.value)),t.DisplacementFactor&&(r.displacementScale=t.DisplacementFactor.value),t.Emissive?r.emissive=(new o["Color"]).fromArray(t.Emissive.value):!t.EmissiveColor||"Color"!==t.EmissiveColor.type&&"ColorRGB"!==t.EmissiveColor.type||(r.emissive=(new o["Color"]).fromArray(t.EmissiveColor.value)),t.EmissiveFactor&&(r.emissiveIntensity=parseFloat(t.EmissiveFactor.value)),t.Opacity&&(r.opacity=parseFloat(t.Opacity.value)),r.opacity<1&&(r.transparent=!0),t.ReflectionFactor&&(r.reflectivity=t.ReflectionFactor.value),t.Shininess&&(r.shininess=t.Shininess.value),t.Specular?r.specular=(new o["Color"]).fromArray(t.Specular.value):t.SpecularColor&&"Color"===t.SpecularColor.type&&(r.specular=(new o["Color"]).fromArray(t.SpecularColor.value));const i=this;return Ue.get(n).children.forEach((function(t){const n=t.relationship;switch(n){case"Bump":r.bumpMap=i.getTexture(e,t.ID);break;case"Maya|TEX_ao_map":r.aoMap=i.getTexture(e,t.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":r.map=i.getTexture(e,t.ID),void 0!==r.map&&(r.map.encoding=o["sRGBEncoding"]);break;case"DisplacementColor":r.displacementMap=i.getTexture(e,t.ID);break;case"EmissiveColor":r.emissiveMap=i.getTexture(e,t.ID),void 0!==r.emissiveMap&&(r.emissiveMap.encoding=o["sRGBEncoding"]);break;case"NormalMap":case"Maya|TEX_normal_map":r.normalMap=i.getTexture(e,t.ID);break;case"ReflectionColor":r.envMap=i.getTexture(e,t.ID),void 0!==r.envMap&&(r.envMap.mapping=o["EquirectangularReflectionMapping"],r.envMap.encoding=o["sRGBEncoding"]);break;case"SpecularColor":r.specularMap=i.getTexture(e,t.ID),void 0!==r.specularMap&&(r.specularMap.encoding=o["sRGBEncoding"]);break;case"TransparentColor":case"TransparencyFactor":r.alphaMap=i.getTexture(e,t.ID),r.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",n);break}})),r}getTexture(t,e){return"LayeredTexture"in Be.Objects&&e in Be.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),e=Ue.get(e).children[0].ID),t.get(e)}parseDeformers(){const t={},e={};if("Deformer"in Be.Objects){const n=Be.Objects.Deformer;for(const r in n){const o=n[r],i=Ue.get(parseInt(r));if("Skin"===o.attrType){const e=this.parseSkeleton(i,n);e.ID=r,i.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),e.geometryID=i.parents[0].ID,t[r]=e}else if("BlendShape"===o.attrType){const t={id:r};t.rawTargets=this.parseMorphTargets(i,n),t.id=r,i.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),e[r]=t}}}return{skeletons:t,morphTargets:e}}parseSkeleton(t,e){const n=[];return t.children.forEach((function(t){const r=e[t.ID];if("Cluster"!==r.attrType)return;const i={ID:t.ID,indices:[],weights:[],transformLink:(new o["Matrix4"]).fromArray(r.TransformLink.a)};"Indexes"in r&&(i.indices=r.Indexes.a,i.weights=r.Weights.a),n.push(i)})),{rawBones:n,bones:[]}}parseMorphTargets(t,e){const n=[];for(let r=0;r<t.children.length;r++){const o=t.children[r],i=e[o.ID],a={name:i.attrName,initialWeight:i.DeformPercent,id:i.id,fullWeights:i.FullWeights.a};if("BlendShapeChannel"!==i.attrType)return;a.geoID=Ue.get(parseInt(o.ID)).children.filter((function(t){return void 0===t.relationship}))[0].ID,n.push(a)}return n}parseScene(t,e,n){ze=new o["Group"];const r=this.parseModels(t.skeletons,e,n),i=Be.Objects.Model,a=this;r.forEach((function(t){const e=i[t.ID];a.setLookAtProperties(t,e);const n=Ue.get(t.ID).parents;n.forEach((function(e){const n=r.get(e.ID);void 0!==n&&n.add(t)})),null===t.parent&&ze.add(t)})),this.bindSkeleton(t.skeletons,e,r),this.createAmbientLight(),ze.traverse((function(t){if(t.userData.transformData){t.parent&&(t.userData.transformData.parentMatrix=t.parent.matrix,t.userData.transformData.parentMatrixWorld=t.parent.matrixWorld);const e=nn(t.userData.transformData);t.applyMatrix4(e),t.updateWorldMatrix()}}));const s=(new Xe).parse();1===ze.children.length&&ze.children[0].isGroup&&(ze.children[0].animations=s,ze=ze.children[0]),ze.animations=s}parseModels(t,e,n){const r=new Map,i=Be.Objects.Model;for(const a in i){const s=parseInt(a),c=i[a],l=Ue.get(s);let u=this.buildSkeleton(l,t,s,c.attrName);if(!u){switch(c.attrType){case"Camera":u=this.createCamera(l);break;case"Light":u=this.createLight(l);break;case"Mesh":u=this.createMesh(l,e,n);break;case"NurbsCurve":u=this.createCurve(l,e);break;case"LimbNode":case"Root":u=new o["Bone"];break;case"Null":default:u=new o["Group"];break}u.name=c.attrName?o["PropertyBinding"].sanitizeNodeName(c.attrName):"",u.ID=s}this.getTransformData(u,c),r.set(s,u)}return r}buildSkeleton(t,e,n,r){let i=null;return t.parents.forEach((function(t){for(const a in e){const s=e[a];s.rawBones.forEach((function(e,a){if(e.ID===t.ID){const t=i;i=new o["Bone"],i.matrixWorld.copy(e.transformLink),i.name=r?o["PropertyBinding"].sanitizeNodeName(r):"",i.ID=n,s.bones[a]=i,null!==t&&i.add(t)}}))}})),i}createCamera(t){let e,n;if(t.children.forEach((function(t){const e=Be.Objects.NodeAttribute[t.ID];void 0!==e&&(n=e)})),void 0===n)e=new o["Object3D"];else{let t=0;void 0!==n.CameraProjectionType&&1===n.CameraProjectionType.value&&(t=1);let r=1;void 0!==n.NearPlane&&(r=n.NearPlane.value/1e3);let i=1e3;void 0!==n.FarPlane&&(i=n.FarPlane.value/1e3);let a=window.innerWidth,s=window.innerHeight;void 0!==n.AspectWidth&&void 0!==n.AspectHeight&&(a=n.AspectWidth.value,s=n.AspectHeight.value);const c=a/s;let l=45;void 0!==n.FieldOfView&&(l=n.FieldOfView.value);const u=n.FocalLength?n.FocalLength.value:null;switch(t){case 0:e=new o["PerspectiveCamera"](l,c,r,i),null!==u&&e.setFocalLength(u);break;case 1:e=new o["OrthographicCamera"](-a/2,a/2,s/2,-s/2,r,i);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+t+"."),e=new o["Object3D"];break}}return e}createLight(t){let e,n;if(t.children.forEach((function(t){const e=Be.Objects.NodeAttribute[t.ID];void 0!==e&&(n=e)})),void 0===n)e=new o["Object3D"];else{let t;t=void 0===n.LightType?0:n.LightType.value;let r=16777215;void 0!==n.Color&&(r=(new o["Color"]).fromArray(n.Color.value));let i=void 0===n.Intensity?1:n.Intensity.value/100;void 0!==n.CastLightOnObject&&0===n.CastLightOnObject.value&&(i=0);let a=0;void 0!==n.FarAttenuationEnd&&(a=void 0!==n.EnableFarAttenuation&&0===n.EnableFarAttenuation.value?0:n.FarAttenuationEnd.value);const s=1;switch(t){case 0:e=new o["PointLight"](r,i,a,s);break;case 1:e=new o["DirectionalLight"](r,i);break;case 2:let t=Math.PI/3;void 0!==n.InnerAngle&&(t=o["MathUtils"].degToRad(n.InnerAngle.value));let c=0;void 0!==n.OuterAngle&&(c=o["MathUtils"].degToRad(n.OuterAngle.value),c=Math.max(c,1)),e=new o["SpotLight"](r,i,a,t,c,s);break;default:console.warn("THREE.FBXLoader: Unknown light type "+n.LightType.value+", defaulting to a PointLight."),e=new o["PointLight"](r,i);break}void 0!==n.CastShadows&&1===n.CastShadows.value&&(e.castShadow=!0)}return e}createMesh(t,e,n){let r,i=null,a=null;const s=[];return t.children.forEach((function(t){e.has(t.ID)&&(i=e.get(t.ID)),n.has(t.ID)&&s.push(n.get(t.ID))})),s.length>1?a=s:s.length>0?a=s[0]:(a=new o["MeshPhongMaterial"]({color:13421772}),s.push(a)),"color"in i.attributes&&s.forEach((function(t){t.vertexColors=!0})),i.FBX_Deformer?(r=new o["SkinnedMesh"](i,a),r.normalizeSkinWeights()):r=new o["Mesh"](i,a),r}createCurve(t,e){const n=t.children.reduce((function(t,n){return e.has(n.ID)&&(t=e.get(n.ID)),t}),null),r=new o["LineBasicMaterial"]({color:3342591,linewidth:1});return new o["Line"](n,r)}getTransformData(t,e){const n={};"InheritType"in e&&(n.inheritType=parseInt(e.InheritType.value)),n.eulerOrder="RotationOrder"in e?rn(e.RotationOrder.value):"ZYX","Lcl_Translation"in e&&(n.translation=e.Lcl_Translation.value),"PreRotation"in e&&(n.preRotation=e.PreRotation.value),"Lcl_Rotation"in e&&(n.rotation=e.Lcl_Rotation.value),"PostRotation"in e&&(n.postRotation=e.PostRotation.value),"Lcl_Scaling"in e&&(n.scale=e.Lcl_Scaling.value),"ScalingOffset"in e&&(n.scalingOffset=e.ScalingOffset.value),"ScalingPivot"in e&&(n.scalingPivot=e.ScalingPivot.value),"RotationOffset"in e&&(n.rotationOffset=e.RotationOffset.value),"RotationPivot"in e&&(n.rotationPivot=e.RotationPivot.value),t.userData.transformData=n}setLookAtProperties(t,e){if("LookAtProperty"in e){const e=Ue.get(t.ID).children;e.forEach((function(e){if("LookAtProperty"===e.relationship){const n=Be.Objects.Model[e.ID];if("Lcl_Translation"in n){const e=n.Lcl_Translation.value;void 0!==t.target?(t.target.position.fromArray(e),ze.add(t.target)):t.lookAt((new o["Vector3"]).fromArray(e))}}}))}}bindSkeleton(t,e,n){const r=this.parsePoseNodes();for(const i in t){const a=t[i],s=Ue.get(parseInt(a.ID)).parents;s.forEach((function(t){if(e.has(t.ID)){const e=t.ID,i=Ue.get(e);i.parents.forEach((function(t){if(n.has(t.ID)){const e=n.get(t.ID);e.bind(new o["Skeleton"](a.bones),r[t.ID])}}))}}))}}parsePoseNodes(){const t={};if("Pose"in Be.Objects){const e=Be.Objects.Pose;for(const n in e)if("BindPose"===e[n].attrType&&e[n].NbPoseNodes>0){const r=e[n].PoseNode;Array.isArray(r)?r.forEach((function(e){t[e.Node]=(new o["Matrix4"]).fromArray(e.Matrix.a)})):t[r.Node]=(new o["Matrix4"]).fromArray(r.Matrix.a)}}return t}createAmbientLight(){if("GlobalSettings"in Be&&"AmbientColor"in Be.GlobalSettings){const t=Be.GlobalSettings.AmbientColor.value,e=t[0],n=t[1],r=t[2];if(0!==e||0!==n||0!==r){const t=new o["Color"](e,n,r);ze.add(new o["AmbientLight"](t,1))}}}}class Ge{parse(t){const e=new Map;if("Geometry"in Be.Objects){const n=Be.Objects.Geometry;for(const r in n){const o=Ue.get(parseInt(r)),i=this.parseGeometry(o,n[r],t);e.set(parseInt(r),i)}}return e}parseGeometry(t,e,n){switch(e.attrType){case"Mesh":return this.parseMeshGeometry(t,e,n);case"NurbsCurve":return this.parseNurbsGeometry(e)}}parseMeshGeometry(t,e,n){const r=n.skeletons,o=[],i=t.parents.map((function(t){return Be.Objects.Model[t.ID]}));if(0===i.length)return;const a=t.children.reduce((function(t,e){return void 0!==r[e.ID]&&(t=r[e.ID]),t}),null);t.children.forEach((function(t){void 0!==n.morphTargets[t.ID]&&o.push(n.morphTargets[t.ID])}));const s=i[0],c={};"RotationOrder"in s&&(c.eulerOrder=rn(s.RotationOrder.value)),"InheritType"in s&&(c.inheritType=parseInt(s.InheritType.value)),"GeometricTranslation"in s&&(c.translation=s.GeometricTranslation.value),"GeometricRotation"in s&&(c.rotation=s.GeometricRotation.value),"GeometricScaling"in s&&(c.scale=s.GeometricScaling.value);const l=nn(c);return this.genGeometry(e,a,o,l)}genGeometry(t,e,n,r){const i=new o["BufferGeometry"];t.attrName&&(i.name=t.attrName);const a=this.parseGeoNode(t,e),s=this.genBuffers(a),c=new o["Float32BufferAttribute"](s.vertex,3);if(c.applyMatrix4(r),i.setAttribute("position",c),s.colors.length>0&&i.setAttribute("color",new o["Float32BufferAttribute"](s.colors,3)),e&&(i.setAttribute("skinIndex",new o["Uint16BufferAttribute"](s.weightsIndices,4)),i.setAttribute("skinWeight",new o["Float32BufferAttribute"](s.vertexWeights,4)),i.FBX_Deformer=e),s.normal.length>0){const t=(new o["Matrix3"]).getNormalMatrix(r),e=new o["Float32BufferAttribute"](s.normal,3);e.applyNormalMatrix(t),i.setAttribute("normal",e)}if(s.uvs.forEach((function(t,e){let n="uv"+(e+1).toString();0===e&&(n="uv"),i.setAttribute(n,new o["Float32BufferAttribute"](s.uvs[e],2))})),a.material&&"AllSame"!==a.material.mappingType){let t=s.materialIndex[0],e=0;if(s.materialIndex.forEach((function(n,r){n!==t&&(i.addGroup(e,r-e,t),t=n,e=r)})),i.groups.length>0){const e=i.groups[i.groups.length-1],n=e.start+e.count;n!==s.materialIndex.length&&i.addGroup(n,s.materialIndex.length-n,t)}0===i.groups.length&&i.addGroup(0,s.materialIndex.length,s.materialIndex[0])}return this.addMorphTargets(i,t,n,r),i}parseGeoNode(t,e){const n={};if(n.vertexPositions=void 0!==t.Vertices?t.Vertices.a:[],n.vertexIndices=void 0!==t.PolygonVertexIndex?t.PolygonVertexIndex.a:[],t.LayerElementColor&&(n.color=this.parseVertexColors(t.LayerElementColor[0])),t.LayerElementMaterial&&(n.material=this.parseMaterialIndices(t.LayerElementMaterial[0])),t.LayerElementNormal&&(n.normal=this.parseNormals(t.LayerElementNormal[0])),t.LayerElementUV){n.uv=[];let e=0;while(t.LayerElementUV[e])t.LayerElementUV[e].UV&&n.uv.push(this.parseUVs(t.LayerElementUV[e])),e++}return n.weightTable={},null!==e&&(n.skeleton=e,e.rawBones.forEach((function(t,e){t.indices.forEach((function(r,o){void 0===n.weightTable[r]&&(n.weightTable[r]=[]),n.weightTable[r].push({id:e,weight:t.weights[o]})}))}))),n}genBuffers(t){const e={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let n=0,r=0,o=!1,i=[],a=[],s=[],c=[],l=[],u=[];const h=this;return t.vertexIndices.forEach((function(f,p){let d,g=!1;f<0&&(f^=-1,g=!0);let m=[],v=[];if(i.push(3*f,3*f+1,3*f+2),t.color){const e=Je(p,n,f,t.color);s.push(e[0],e[1],e[2])}if(t.skeleton){if(void 0!==t.weightTable[f]&&t.weightTable[f].forEach((function(t){v.push(t.weight),m.push(t.id)})),v.length>4){o||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),o=!0);const t=[0,0,0,0],e=[0,0,0,0];v.forEach((function(n,r){let o=n,i=m[r];e.forEach((function(e,n,r){if(o>e){r[n]=o,o=e;const a=t[n];t[n]=i,i=a}}))})),m=t,v=e}while(v.length<4)v.push(0),m.push(0);for(let t=0;t<4;++t)l.push(v[t]),u.push(m[t])}if(t.normal){const e=Je(p,n,f,t.normal);a.push(e[0],e[1],e[2])}t.material&&"AllSame"!==t.material.mappingType&&(d=Je(p,n,f,t.material)[0]),t.uv&&t.uv.forEach((function(t,e){const r=Je(p,n,f,t);void 0===c[e]&&(c[e]=[]),c[e].push(r[0]),c[e].push(r[1])})),r++,g&&(h.genFace(e,t,i,d,a,s,c,l,u,r),n++,r=0,i=[],a=[],s=[],c=[],l=[],u=[])})),e}genFace(t,e,n,r,o,i,a,s,c,l){for(let u=2;u<l;u++)t.vertex.push(e.vertexPositions[n[0]]),t.vertex.push(e.vertexPositions[n[1]]),t.vertex.push(e.vertexPositions[n[2]]),t.vertex.push(e.vertexPositions[n[3*(u-1)]]),t.vertex.push(e.vertexPositions[n[3*(u-1)+1]]),t.vertex.push(e.vertexPositions[n[3*(u-1)+2]]),t.vertex.push(e.vertexPositions[n[3*u]]),t.vertex.push(e.vertexPositions[n[3*u+1]]),t.vertex.push(e.vertexPositions[n[3*u+2]]),e.skeleton&&(t.vertexWeights.push(s[0]),t.vertexWeights.push(s[1]),t.vertexWeights.push(s[2]),t.vertexWeights.push(s[3]),t.vertexWeights.push(s[4*(u-1)]),t.vertexWeights.push(s[4*(u-1)+1]),t.vertexWeights.push(s[4*(u-1)+2]),t.vertexWeights.push(s[4*(u-1)+3]),t.vertexWeights.push(s[4*u]),t.vertexWeights.push(s[4*u+1]),t.vertexWeights.push(s[4*u+2]),t.vertexWeights.push(s[4*u+3]),t.weightsIndices.push(c[0]),t.weightsIndices.push(c[1]),t.weightsIndices.push(c[2]),t.weightsIndices.push(c[3]),t.weightsIndices.push(c[4*(u-1)]),t.weightsIndices.push(c[4*(u-1)+1]),t.weightsIndices.push(c[4*(u-1)+2]),t.weightsIndices.push(c[4*(u-1)+3]),t.weightsIndices.push(c[4*u]),t.weightsIndices.push(c[4*u+1]),t.weightsIndices.push(c[4*u+2]),t.weightsIndices.push(c[4*u+3])),e.color&&(t.colors.push(i[0]),t.colors.push(i[1]),t.colors.push(i[2]),t.colors.push(i[3*(u-1)]),t.colors.push(i[3*(u-1)+1]),t.colors.push(i[3*(u-1)+2]),t.colors.push(i[3*u]),t.colors.push(i[3*u+1]),t.colors.push(i[3*u+2])),e.material&&"AllSame"!==e.material.mappingType&&(t.materialIndex.push(r),t.materialIndex.push(r),t.materialIndex.push(r)),e.normal&&(t.normal.push(o[0]),t.normal.push(o[1]),t.normal.push(o[2]),t.normal.push(o[3*(u-1)]),t.normal.push(o[3*(u-1)+1]),t.normal.push(o[3*(u-1)+2]),t.normal.push(o[3*u]),t.normal.push(o[3*u+1]),t.normal.push(o[3*u+2])),e.uv&&e.uv.forEach((function(e,n){void 0===t.uvs[n]&&(t.uvs[n]=[]),t.uvs[n].push(a[n][0]),t.uvs[n].push(a[n][1]),t.uvs[n].push(a[n][2*(u-1)]),t.uvs[n].push(a[n][2*(u-1)+1]),t.uvs[n].push(a[n][2*u]),t.uvs[n].push(a[n][2*u+1])}))}addMorphTargets(t,e,n,r){if(0===n.length)return;t.morphTargetsRelative=!0,t.morphAttributes.position=[];const o=this;n.forEach((function(n){n.rawTargets.forEach((function(n){const i=Be.Objects.Geometry[n.geoID];void 0!==i&&o.genMorphGeometry(t,e,i,r,n.name)}))}))}genMorphGeometry(t,e,n,r,i){const a=void 0!==e.PolygonVertexIndex?e.PolygonVertexIndex.a:[],s=void 0!==n.Vertices?n.Vertices.a:[],c=void 0!==n.Indexes?n.Indexes.a:[],l=3*t.attributes.position.count,u=new Float32Array(l);for(let o=0;o<c.length;o++){const t=3*c[o];u[t]=s[3*o],u[t+1]=s[3*o+1],u[t+2]=s[3*o+2]}const h={vertexIndices:a,vertexPositions:u},f=this.genBuffers(h),p=new o["Float32BufferAttribute"](f.vertex,3);p.name=i||n.attrName,p.applyMatrix4(r),t.morphAttributes.position.push(p)}parseNormals(t){const e=t.MappingInformationType,n=t.ReferenceInformationType,r=t.Normals.a;let o=[];return"IndexToDirect"===n&&("NormalIndex"in t?o=t.NormalIndex.a:"NormalsIndex"in t&&(o=t.NormalsIndex.a)),{dataSize:3,buffer:r,indices:o,mappingType:e,referenceType:n}}parseUVs(t){const e=t.MappingInformationType,n=t.ReferenceInformationType,r=t.UV.a;let o=[];return"IndexToDirect"===n&&(o=t.UVIndex.a),{dataSize:2,buffer:r,indices:o,mappingType:e,referenceType:n}}parseVertexColors(t){const e=t.MappingInformationType,n=t.ReferenceInformationType,r=t.Colors.a;let o=[];return"IndexToDirect"===n&&(o=t.ColorIndex.a),{dataSize:4,buffer:r,indices:o,mappingType:e,referenceType:n}}parseMaterialIndices(t){const e=t.MappingInformationType,n=t.ReferenceInformationType;if("NoMappingInformation"===e)return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:n};const r=t.Materials.a,o=[];for(let i=0;i<r.length;++i)o.push(i);return{dataSize:1,buffer:r,indices:o,mappingType:e,referenceType:n}}parseNurbsGeometry(t){if(void 0===Oe)return console.error("THREE.FBXLoader: The loader relies on NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new o["BufferGeometry"];const e=parseInt(t.Order);if(isNaN(e))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",t.Order,t.id),new o["BufferGeometry"];const n=e-1,r=t.KnotVector.a,i=[],a=t.Points.a;for(let h=0,f=a.length;h<f;h+=4)i.push((new o["Vector4"]).fromArray(a,h));let s,c;if("Closed"===t.Form)i.push(i[0]);else if("Periodic"===t.Form){s=n,c=r.length-1-s;for(let t=0;t<n;++t)i.push(i[t])}const l=new Oe(n,r,i,s,c),u=l.getPoints(12*i.length);return(new o["BufferGeometry"]).setFromPoints(u)}}class Xe{parse(){const t=[],e=this.parseClips();if(void 0!==e)for(const n in e){const r=e[n],o=this.addClip(r);t.push(o)}return t}parseClips(){if(void 0===Be.Objects.AnimationCurve)return;const t=this.parseAnimationCurveNodes();this.parseAnimationCurves(t);const e=this.parseAnimationLayers(t),n=this.parseAnimStacks(e);return n}parseAnimationCurveNodes(){const t=Be.Objects.AnimationCurveNode,e=new Map;for(const n in t){const r=t[n];if(null!==r.attrName.match(/S|R|T|DeformPercent/)){const t={id:r.id,attr:r.attrName,curves:{}};e.set(t.id,t)}}return e}parseAnimationCurves(t){const e=Be.Objects.AnimationCurve;for(const n in e){const r={id:e[n].id,times:e[n].KeyTime.a.map(Qe),values:e[n].KeyValueFloat.a},o=Ue.get(r.id);if(void 0!==o){const e=o.parents[0].ID,n=o.parents[0].relationship;n.match(/X/)?t.get(e).curves["x"]=r:n.match(/Y/)?t.get(e).curves["y"]=r:n.match(/Z/)?t.get(e).curves["z"]=r:n.match(/d|DeformPercent/)&&t.has(e)&&(t.get(e).curves["morph"]=r)}}}parseAnimationLayers(t){const e=Be.Objects.AnimationLayer,n=new Map;for(const r in e){const e=[],i=Ue.get(parseInt(r));if(void 0!==i){const a=i.children;a.forEach((function(n,r){if(t.has(n.ID)){const i=t.get(n.ID);if(void 0!==i.curves.x||void 0!==i.curves.y||void 0!==i.curves.z){if(void 0===e[r]){const t=Ue.get(n.ID).parents.filter((function(t){return void 0!==t.relationship}))[0].ID;if(void 0!==t){const i=Be.Objects.Model[t.toString()];if(void 0===i)return void console.warn("THREE.FBXLoader: Encountered a unused curve.",n);const a={modelName:i.attrName?o["PropertyBinding"].sanitizeNodeName(i.attrName):"",ID:i.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};ze.traverse((function(t){t.ID===i.id&&(a.transform=t.matrix,t.userData.transformData&&(a.eulerOrder=t.userData.transformData.eulerOrder))})),a.transform||(a.transform=new o["Matrix4"]),"PreRotation"in i&&(a.preRotation=i.PreRotation.value),"PostRotation"in i&&(a.postRotation=i.PostRotation.value),e[r]=a}}e[r]&&(e[r][i.attr]=i)}else if(void 0!==i.curves.morph){if(void 0===e[r]){const t=Ue.get(n.ID).parents.filter((function(t){return void 0!==t.relationship}))[0].ID,i=Ue.get(t).parents[0].ID,a=Ue.get(i).parents[0].ID,s=Ue.get(a).parents[0].ID,c=Be.Objects.Model[s],l={modelName:c.attrName?o["PropertyBinding"].sanitizeNodeName(c.attrName):"",morphName:Be.Objects.Deformer[t].attrName};e[r]=l}e[r][i.attr]=i}}})),n.set(parseInt(r),e)}}return n}parseAnimStacks(t){const e=Be.Objects.AnimationStack,n={};for(const r in e){const o=Ue.get(parseInt(r)).children;o.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const i=t.get(o[0].ID);n[r]={name:e[r].attrName,layer:i}}return n}addClip(t){let e=[];const n=this;return t.layer.forEach((function(t){e=e.concat(n.generateTracks(t))})),new o["AnimationClip"](t.name,-1,e)}generateTracks(t){const e=[];let n=new o["Vector3"],r=new o["Quaternion"],i=new o["Vector3"];if(t.transform&&t.transform.decompose(n,r,i),n=n.toArray(),r=(new o["Euler"]).setFromQuaternion(r,t.eulerOrder).toArray(),i=i.toArray(),void 0!==t.T&&Object.keys(t.T.curves).length>0){const r=this.generateVectorTrack(t.modelName,t.T.curves,n,"position");void 0!==r&&e.push(r)}if(void 0!==t.R&&Object.keys(t.R.curves).length>0){const n=this.generateRotationTrack(t.modelName,t.R.curves,r,t.preRotation,t.postRotation,t.eulerOrder);void 0!==n&&e.push(n)}if(void 0!==t.S&&Object.keys(t.S.curves).length>0){const n=this.generateVectorTrack(t.modelName,t.S.curves,i,"scale");void 0!==n&&e.push(n)}if(void 0!==t.DeformPercent){const n=this.generateMorphTrack(t);void 0!==n&&e.push(n)}return e}generateVectorTrack(t,e,n,r){const i=this.getTimesForAllAxes(e),a=this.getKeyframeTrackValues(i,e,n);return new o["VectorKeyframeTrack"](t+"."+r,i,a)}generateRotationTrack(t,e,n,r,i,a){void 0!==e.x&&(this.interpolateRotations(e.x),e.x.values=e.x.values.map(o["MathUtils"].degToRad)),void 0!==e.y&&(this.interpolateRotations(e.y),e.y.values=e.y.values.map(o["MathUtils"].degToRad)),void 0!==e.z&&(this.interpolateRotations(e.z),e.z.values=e.z.values.map(o["MathUtils"].degToRad));const s=this.getTimesForAllAxes(e),c=this.getKeyframeTrackValues(s,e,n);void 0!==r&&(r=r.map(o["MathUtils"].degToRad),r.push(a),r=(new o["Euler"]).fromArray(r),r=(new o["Quaternion"]).setFromEuler(r)),void 0!==i&&(i=i.map(o["MathUtils"].degToRad),i.push(a),i=(new o["Euler"]).fromArray(i),i=(new o["Quaternion"]).setFromEuler(i).invert());const l=new o["Quaternion"],u=new o["Euler"],h=[];for(let o=0;o<c.length;o+=3)u.set(c[o],c[o+1],c[o+2],a),l.setFromEuler(u),void 0!==r&&l.premultiply(r),void 0!==i&&l.multiply(i),l.toArray(h,o/3*4);return new o["QuaternionKeyframeTrack"](t+".quaternion",s,h)}generateMorphTrack(t){const e=t.DeformPercent.curves.morph,n=e.values.map((function(t){return t/100})),r=ze.getObjectByName(t.modelName).morphTargetDictionary[t.morphName];return new o["NumberKeyframeTrack"](t.modelName+".morphTargetInfluences["+r+"]",e.times,n)}getTimesForAllAxes(t){let e=[];if(void 0!==t.x&&(e=e.concat(t.x.times)),void 0!==t.y&&(e=e.concat(t.y.times)),void 0!==t.z&&(e=e.concat(t.z.times)),e=e.sort((function(t,e){return t-e})),e.length>1){let t=1,n=e[0];for(let r=1;r<e.length;r++){const o=e[r];o!==n&&(e[t]=o,n=o,t++)}e=e.slice(0,t)}return e}getKeyframeTrackValues(t,e,n){const r=n,o=[];let i=-1,a=-1,s=-1;return t.forEach((function(t){if(e.x&&(i=e.x.times.indexOf(t)),e.y&&(a=e.y.times.indexOf(t)),e.z&&(s=e.z.times.indexOf(t)),-1!==i){const t=e.x.values[i];o.push(t),r[0]=t}else o.push(r[0]);if(-1!==a){const t=e.y.values[a];o.push(t),r[1]=t}else o.push(r[1]);if(-1!==s){const t=e.z.values[s];o.push(t),r[2]=t}else o.push(r[2])})),o}interpolateRotations(t){for(let e=1;e<t.values.length;e++){const n=t.values[e-1],r=t.values[e]-n,o=Math.abs(r);if(o>=180){const i=o/180,a=r/i;let s=n+a;const c=t.times[e-1],l=t.times[e]-c,u=l/i;let h=c+u;const f=[],p=[];while(h<t.times[e])f.push(h),h+=u,p.push(s),s+=a;t.times=ln(t.times,e,f),t.values=ln(t.values,e,p)}}}}class We{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(t){this.nodeStack.push(t),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(t,e){this.currentProp=t,this.currentPropName=e}parse(t){this.currentIndent=0,this.allNodes=new Ze,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const e=this,n=t.split(/[\r\n]+/);return n.forEach((function(t,r){const o=t.match(/^[\s\t]*;/),i=t.match(/^[\s\t]*$/);if(o||i)return;const a=t.match("^\\t{"+e.currentIndent+"}(\\w+):(.*){",""),s=t.match("^\\t{"+e.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),c=t.match("^\\t{"+(e.currentIndent-1)+"}}");a?e.parseNodeBegin(t,a):s?e.parseNodeProperty(t,s,n[++r]):c?e.popStack():t.match(/^[^\s\t}]/)&&e.parseNodePropertyContinued(t)})),this.allNodes}parseNodeBegin(t,e){const n=e[1].trim().replace(/^"/,"").replace(/"$/,""),r=e[2].split(",").map((function(t){return t.trim().replace(/^"/,"").replace(/"$/,"")})),o={name:n},i=this.parseNodeAttr(r),a=this.getCurrentNode();0===this.currentIndent?this.allNodes.add(n,o):n in a?("PoseNode"===n?a.PoseNode.push(o):void 0!==a[n].id&&(a[n]={},a[n][a[n].id]=a[n]),""!==i.id&&(a[n][i.id]=o)):"number"===typeof i.id?(a[n]={},a[n][i.id]=o):"Properties70"!==n&&(a[n]="PoseNode"===n?[o]:o),"number"===typeof i.id&&(o.id=i.id),""!==i.name&&(o.attrName=i.name),""!==i.type&&(o.attrType=i.type),this.pushStack(o)}parseNodeAttr(t){let e=t[0];""!==t[0]&&(e=parseInt(t[0]),isNaN(e)&&(e=t[0]));let n="",r="";return t.length>1&&(n=t[1].replace(/^(\w+)::/,""),r=t[2]),{id:e,name:n,type:r}}parseNodeProperty(t,e,n){let r=e[1].replace(/^"/,"").replace(/"$/,"").trim(),o=e[2].replace(/^"/,"").replace(/"$/,"").trim();"Content"===r&&","===o&&(o=n.replace(/"/g,"").replace(/,$/,"").trim());const i=this.getCurrentNode(),a=i.name;if("Properties70"!==a){if("C"===r){const t=o.split(",").slice(1),e=parseInt(t[0]),n=parseInt(t[1]);let a=o.split(",").slice(3);a=a.map((function(t){return t.trim().replace(/^"/,"")})),r="connections",o=[e,n],sn(o,a),void 0===i[r]&&(i[r]=[])}"Node"===r&&(i.id=o),r in i&&Array.isArray(i[r])?i[r].push(o):"a"!==r?i[r]=o:i.a=o,this.setCurrentProp(i,r),"a"===r&&","!==o.slice(-1)&&(i.a=on(o))}else this.parseNodeSpecialProperty(t,r,o)}parseNodePropertyContinued(t){const e=this.getCurrentNode();e.a+=t,","!==t.slice(-1)&&(e.a=on(e.a))}parseNodeSpecialProperty(t,e,n){const r=n.split('",').map((function(t){return t.trim().replace(/^\"/,"").replace(/\s/,"_")})),o=r[0],i=r[1],a=r[2],s=r[3];let c=r[4];switch(i){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":c=parseFloat(c);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":c=on(c);break}this.getPrevNode()[o]={type:i,type2:a,flag:s,value:c},this.setCurrentProp(this.getPrevNode(),o)}}class He{parse(t){const e=new _e(t);e.skip(23);const n=e.getUint32();if(n<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+n);const r=new Ze;while(!this.endOfContent(e)){const t=this.parseNode(e,n);null!==t&&r.add(t.name,t)}return r}endOfContent(t){return t.size()%16===0?(t.getOffset()+160+16&-16)>=t.size():t.getOffset()+160+16>=t.size()}parseNode(t,e){const n={},r=e>=7500?t.getUint64():t.getUint32(),o=e>=7500?t.getUint64():t.getUint32();e>=7500?t.getUint64():t.getUint32();const i=t.getUint8(),a=t.getString(i);if(0===r)return null;const s=[];for(let h=0;h<o;h++)s.push(this.parseProperty(t));const c=s.length>0?s[0]:"",l=s.length>1?s[1]:"",u=s.length>2?s[2]:"";n.singleProperty=1===o&&t.getOffset()===r;while(r>t.getOffset()){const r=this.parseNode(t,e);null!==r&&this.parseSubNode(a,n,r)}return n.propertyList=s,"number"===typeof c&&(n.id=c),""!==l&&(n.attrName=l),""!==u&&(n.attrType=u),""!==a&&(n.name=a),n}parseSubNode(t,e,n){if(!0===n.singleProperty){const t=n.propertyList[0];Array.isArray(t)?(e[n.name]=n,n.a=t):e[n.name]=t}else if("Connections"===t&&"C"===n.name){const t=[];n.propertyList.forEach((function(e,n){0!==n&&t.push(e)})),void 0===e.connections&&(e.connections=[]),e.connections.push(t)}else if("Properties70"===n.name){const t=Object.keys(n);t.forEach((function(t){e[t]=n[t]}))}else if("Properties70"===t&&"P"===n.name){let t=n.propertyList[0],r=n.propertyList[1];const o=n.propertyList[2],i=n.propertyList[3];let a;0===t.indexOf("Lcl ")&&(t=t.replace("Lcl ","Lcl_")),0===r.indexOf("Lcl ")&&(r=r.replace("Lcl ","Lcl_")),a="Color"===r||"ColorRGB"===r||"Vector"===r||"Vector3D"===r||0===r.indexOf("Lcl_")?[n.propertyList[4],n.propertyList[5],n.propertyList[6]]:n.propertyList[4],e[t]={type:r,type2:o,flag:i,value:a}}else void 0===e[n.name]?"number"===typeof n.id?(e[n.name]={},e[n.name][n.id]=n):e[n.name]=n:"PoseNode"===n.name?(Array.isArray(e[n.name])||(e[n.name]=[e[n.name]]),e[n.name].push(n)):void 0===e[n.name][n.id]&&(e[n.name][n.id]=n)}parseProperty(t){const e=t.getString(1);let n;switch(e){case"C":return t.getBoolean();case"D":return t.getFloat64();case"F":return t.getFloat32();case"I":return t.getInt32();case"L":return t.getInt64();case"R":return n=t.getUint32(),t.getArrayBuffer(n);case"S":return n=t.getUint32(),t.getString(n);case"Y":return t.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const o=t.getUint32(),i=t.getUint32(),a=t.getUint32();if(0===i)switch(e){case"b":case"c":return t.getBooleanArray(o);case"d":return t.getFloat64Array(o);case"f":return t.getFloat32Array(o);case"i":return t.getInt32Array(o);case"l":return t.getInt64Array(o)}"undefined"===typeof r&&console.error("THREE.FBXLoader: External library fflate.min.js required.");const s=Yt(new Uint8Array(t.getArrayBuffer(a))),c=new _e(s.buffer);switch(e){case"b":case"c":return c.getBooleanArray(o);case"d":return c.getFloat64Array(o);case"f":return c.getFloat32Array(o);case"i":return c.getInt32Array(o);case"l":return c.getInt64Array(o)}break;default:throw new Error("THREE.FBXLoader: Unknown property type "+e)}}}class _e{constructor(t,e){this.dv=new DataView(t),this.offset=0,this.littleEndian=void 0===e||e}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(t){this.offset+=t}getBoolean(){return 1===(1&this.getUint8())}getBooleanArray(t){const e=[];for(let n=0;n<t;n++)e.push(this.getBoolean());return e}getUint8(){const t=this.dv.getUint8(this.offset);return this.offset+=1,t}getInt16(){const t=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}getInt32(){const t=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}getInt32Array(t){const e=[];for(let n=0;n<t;n++)e.push(this.getInt32());return e}getUint32(){const t=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}getInt64(){let t,e;return this.littleEndian?(t=this.getUint32(),e=this.getUint32()):(e=this.getUint32(),t=this.getUint32()),2147483648&e?(e=4294967295&~e,t=4294967295&~t,4294967295===t&&(e=e+1&4294967295),t=t+1&4294967295,-(4294967296*e+t)):4294967296*e+t}getInt64Array(t){const e=[];for(let n=0;n<t;n++)e.push(this.getInt64());return e}getUint64(){let t,e;return this.littleEndian?(t=this.getUint32(),e=this.getUint32()):(e=this.getUint32(),t=this.getUint32()),4294967296*e+t}getFloat32(){const t=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}getFloat32Array(t){const e=[];for(let n=0;n<t;n++)e.push(this.getFloat32());return e}getFloat64(){const t=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}getFloat64Array(t){const e=[];for(let n=0;n<t;n++)e.push(this.getFloat64());return e}getArrayBuffer(t){const e=this.dv.buffer.slice(this.offset,this.offset+t);return this.offset+=t,e}getString(t){let e=[];for(let r=0;r<t;r++)e[r]=this.getUint8();const n=e.indexOf(0);return n>=0&&(e=e.slice(0,n)),o["LoaderUtils"].decodeText(new Uint8Array(e))}}class Ze{add(t,e){this[t]=e}}function Ke(t){const e="Kaydara FBX Binary  \0";return t.byteLength>=e.length&&e===an(t,0,e.length)}function Ye(t){const e=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let n=0;function r(e){const r=t[e-1];return t=t.slice(n+e),n++,r}for(let o=0;o<e.length;++o){const t=r(1);if(t===e[o])return!1}return!0}function qe(t){const e=/FBXVersion: (\d+)/,n=t.match(e);if(n){const t=parseInt(n[1]);return t}throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function Qe(t){return t/46186158e3}const $e=[];function Je(t,e,n,r){let o;switch(r.mappingType){case"ByPolygonVertex":o=t;break;case"ByPolygon":o=e;break;case"ByVertice":o=n;break;case"AllSame":o=r.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+r.mappingType)}"IndexToDirect"===r.referenceType&&(o=r.indices[o]);const i=o*r.dataSize,a=i+r.dataSize;return cn($e,r.buffer,i,a)}const tn=new o["Euler"],en=new o["Vector3"];function nn(t){const e=new o["Matrix4"],n=new o["Matrix4"],r=new o["Matrix4"],i=new o["Matrix4"],a=new o["Matrix4"],s=new o["Matrix4"],c=new o["Matrix4"],l=new o["Matrix4"],u=new o["Matrix4"],h=new o["Matrix4"],f=new o["Matrix4"],p=new o["Matrix4"],d=t.inheritType?t.inheritType:0;if(t.translation&&e.setPosition(en.fromArray(t.translation)),t.preRotation){const e=t.preRotation.map(o["MathUtils"].degToRad);e.push(t.eulerOrder),n.makeRotationFromEuler(tn.fromArray(e))}if(t.rotation){const e=t.rotation.map(o["MathUtils"].degToRad);e.push(t.eulerOrder),r.makeRotationFromEuler(tn.fromArray(e))}if(t.postRotation){const e=t.postRotation.map(o["MathUtils"].degToRad);e.push(t.eulerOrder),i.makeRotationFromEuler(tn.fromArray(e)),i.invert()}t.scale&&a.scale(en.fromArray(t.scale)),t.scalingOffset&&c.setPosition(en.fromArray(t.scalingOffset)),t.scalingPivot&&s.setPosition(en.fromArray(t.scalingPivot)),t.rotationOffset&&l.setPosition(en.fromArray(t.rotationOffset)),t.rotationPivot&&u.setPosition(en.fromArray(t.rotationPivot)),t.parentMatrixWorld&&(f.copy(t.parentMatrix),h.copy(t.parentMatrixWorld));const g=n.clone().multiply(r).multiply(i),m=new o["Matrix4"];m.extractRotation(h);const v=new o["Matrix4"];v.copyPosition(h);const y=v.clone().invert().multiply(h),w=m.clone().invert().multiply(y),b=a,x=new o["Matrix4"];if(0===d)x.copy(m).multiply(g).multiply(w).multiply(b);else if(1===d)x.copy(m).multiply(w).multiply(g).multiply(b);else{const t=(new o["Matrix4"]).scale((new o["Vector3"]).setFromMatrixScale(f)),e=t.clone().invert(),n=w.clone().multiply(e);x.copy(m).multiply(g).multiply(n).multiply(b)}const I=u.clone().invert(),T=s.clone().invert();let k=e.clone().multiply(l).multiply(u).multiply(n).multiply(r).multiply(i).multiply(I).multiply(c).multiply(s).multiply(a).multiply(T);const M=(new o["Matrix4"]).copyPosition(k),A=h.clone().multiply(M);return p.copyPosition(A),k=p.clone().multiply(x),k.premultiply(h.invert()),k}function rn(t){t=t||0;const e=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return 6===t?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),e[0]):e[t]}function on(t){const e=t.split(",").map((function(t){return parseFloat(t)}));return e}function an(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=t.byteLength),o["LoaderUtils"].decodeText(new Uint8Array(t,e,n))}function sn(t,e){for(let n=0,r=t.length,o=e.length;n<o;n++,r++)t[r]=e[n]}function cn(t,e,n,r){for(let o=n,i=0;o<r;o++,i++)t[i]=e[o];return t}function ln(t,e,n){return t.slice(0,e).concat(n).concat(t.slice(e))}}}]);